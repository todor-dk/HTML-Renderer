<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>research!rsc: Glob Matching Can Be Simple And Fast Too</title>
    <link rel="alternate" type="application/atom+xml" title="research!rsc - Atom" href="http://research.swtch.com/feed.atom" />
    
<link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="https://use.typekit.com/skm6yij.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<style>
  body {
    padding: 0;
    margin: 0;
    font-size: 100%;
  }
  .header {
    height: 1.25em;
    background-color: #dff;
    margin: 0;
    padding: 0.1em 0.1em 0.2em;
    border-top: 1px solid black;
    border-bottom: 1px solid #8ff;
  }
  .header h3 {
    margin: 0;
    padding: 0 2em;
    display: inline-block;
    padding-right: 2em;
    font-style: italic;
    font-family: "adobe-text-pro" !important;
    font-size: 90%;
  }
  .rss {
    float: right;
    padding-top: 0.2em;
    padding-right: 2em;
    display: none;
  }
  .toc {
    margin-top: 2em;
  }
  .toc-title {
    font-family: "caflisch-script-pro";
    font-size: 300%;
    line-height: 50%;
  }
  .toc-subtitle {
    display: block;
    margin-bottom: 1em;
    font-size: 83%;
  }
  @media only screen and (max-width: 550px) { .toc-subtitle { display: none; } }
  .header h3 a {
    color: black;
  }
  .header h4 {
    margin: 0;
    padding: 0;
    display: inline-block;
    font-weight: normal;
    font-size: 83%;
  }
  @media only screen and (max-width: 550px) { .header h4 { display: none; } }
  .main {
    padding: 0 2em;
  }
  @media only screen and (max-width: 479px) { .article { font-size: 120%; } }
  .article h1 {
    text-align: center;
  }
  .article h1, .article h2, .article h3 {
      font-family: 'Myriad Pro';
  }
  .normal {
    font-size: medium;
    font-weight: normal;
  }
  .when {
    text-align: center;
    font-size: 100%;
    margin: 0;
    padding: 0;
  }
  .when p {
    margin: 0;
    padding: 0;
  }
  .article h2 {
    font-size: 100%;
    padding-top: 0.25em;
  }
  pre {
    margin-left: 4em;
    margin-right: 4em;
  }
  pre, code {
    font-family: 'Inconsolata', monospace;
    font-size: 100%;
  }
  .footer {
    margin-top: 10px;
    font-size: 83%;
    font-family: sans-serif;
  }
  .comments {
    margin-top: 2em;
    background-color: #ffe;
    border-top: 1px solid #aa4;
    border-left: 1px solid #aa4;
    border-right: 1px solid #aa4;
  }
  .comments-header {
    padding: 0 5px 0 5px;
  }
  .comments-header p {
    padding: 0;
    margin: 3px 0 0 0;
  }
  .comments-body {
    padding: 5px 5px 5px 5px;
  }
  #plus-comments {
    border-bottom: 1px dotted #ccc;
  }
  .plus-comment {
    width: 100%;
    font-size: 14px;
    border-top: 1px dotted #ccc;
  }
  .me {
    background-color: #eec;
  }
  .plus-comment ul {
    margin: 0;
    padding: 0;
    list-style: none;
    width: 100%;
    display: inline-block;
  }
  .comment-when {
    color:#999;
    width:auto;
    padding:0 5px;
  }
  .old {
    font-size: 83%;
  }
  .plus-comment ul li {
    display: inline-block;
    vertical-align: top;
    margin-top: 5px;
    margin-bottom: 5px;
    padding: 0;
  }
  .plus-icon {
    width: 45px;
  }
  .plus-img {
    float: left;
    margin: 4px 4px 4px 4px;
    width: 32px;
    height: 32px;
  }
  .plus-comment p {
    margin: 0;
    padding: 0;
  }
  .plus-clear {
    clear: left;
  }
  .toc-when {
    font-size: 83%;
    color: #ccc;
  }
  .toc {
    list-style: none;
  }
  .toc li {
    margin-bottom: 0.5em;
  }
  .toc-head {
    margin-bottom: 1em !important;
    font-size: 117%;
  }
  .toc-summary {
    margin-left: 2em;
  }
  .favorite {
    font-weight: bold;
  }
  .article p {
    line-height: 144%;
  }
  sup, sub {
    vertical-align: baseline;
    position: relative;
    font-size: 83%;
  }
  sup {
    bottom: 1ex;
  }
  sub {
    top: 0.8ex;
  }

  .main {
    position: relative;
    margin: 0 auto;
    padding: 0;
    width: 900px;
  }
  @media only screen and (min-width: 768px) and (max-width: 959px) { .main { width: 708px; } }
  @media only screen and (min-width: 640px) and (max-width: 767px) { .main { width: 580px; } }
  @media only screen and (min-width: 480px) and (max-width: 639px) { .main { width: 420px; } }
  @media only screen and (max-width: 479px) { .main { width: 300px; } }

</style>

  </head>
  <body>
    
<div class="header">
  <h3><a href="/">research!rsc</a></h3>
  <h4>Thoughts and links about programming,
    by <a href="https://swtch.com/~rsc/" rel="author">Russ Cox</a> </h4>
  <a class="rss" href="/feed.atom"><img src="/feed-icon-14x14.png" /></a>
</div>

    <div class="main">
      <div class="article">
        <h1>Glob Matching Can Be Simple And Fast Too
        <div class="normal">
        <div class="when">
          
            Posted on Monday, April 24, 2017.
            
          
        </div>
        </div>
        </h1>
        <p class=lp>Here&rsquo;s a straightforward benchmark.
Time how long it takes to run <code>ls</code> (<code>a*</code>)<sup><i>n</i></sup><code>b</code>
in a directory with a single file named <code>a</code><sup>100</sup>,
compared to running <code>ls</code> <code>|</code> <code>grep</code> (<code>a.*</code>)<sup><i>n</i></sup><code>b</code>.
Superscripts denote string repetition and parentheses are for grouping only,
so that when <i>n</i> is 3, we&rsquo;re running <code>ls</code> <code>a*a*a*b</code> in a directory containing the single file <code>aaa</code>&hellip;<code>aaa</code> (100 <code>a</code>&rsquo;s),
compared against <code>ls</code> <code>|</code> <code>grep</code> <code>a.*a.*a.*b</code> in the same directory.</p>

<div class=fig>
<center>
<table cellspacing=0 cellpadding=0 border=0>
<tr><td valign=bottom>

<svg width="234pt" height="151pt" viewBox="0 0 234 151"
     xmlns="http://www.w3.org/2000/svg">
<defs>
<clipPath id="grid"><rect x="36.00" y="7.20" width="180.00" height="108.00"/></clipPath></defs>
<path d="M 36.00 115.20 L 36.00 7.20 M 36.00 115.20 L 216.00 115.20 M 36.00 115.20 L 36.00 120.20 M 58.50 115.20 L 58.50 120.20 M 81.00 115.20 L 81.00 120.20 M 103.50 115.20 L 103.50 120.20 M 126.00 115.20 L 126.00 120.20 M 148.50 115.20 L 148.50 120.20 M 171.00 115.20 L 171.00 120.20 M 193.50 115.20 L 193.50 120.20 M 216.00 115.20 L 216.00 120.20 M 36.00 115.20 L 31.00 115.20 M 36.00 100.30 L 31.00 100.30 M 36.00 85.41 L 31.00 85.41 M 36.00 70.51 L 31.00 70.51 M 36.00 55.61 L 31.00 55.61 M 36.00 40.72 L 31.00 40.72 M 36.00 25.82 L 31.00 25.82 M 36.00 10.92 L 31.00 10.92 " fill="transparent" stroke="black"/>
<text x="36.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">0</text>
<text x="58.50" y="120.20" dy="1em" text-anchor="middle" font-size="10">1</text>
<text x="81.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">2</text>
<text x="103.50" y="120.20" dy="1em" text-anchor="middle" font-size="10">3</text>
<text x="126.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">4</text>
<text x="148.50" y="120.20" dy="1em" text-anchor="middle" font-size="10">5</text>
<text x="171.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">6</text>
<text x="193.50" y="120.20" dy="1em" text-anchor="middle" font-size="10">7</text>
<text x="216.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">8</text>
<text x="31.00" y="115.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">0</text>
<text x="31.00" y="100.30" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1</text>
<text x="31.00" y="85.41" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">2</text>
<text x="31.00" y="70.51" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">3</text>
<text x="31.00" y="55.61" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">4</text>
<text x="31.00" y="40.72" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">5</text>
<text x="31.00" y="25.82" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">6</text>
<text x="31.00" y="10.92" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">7</text>
<text x="126.00" y="115.20" text-anchor="middle" font-size="11" dy="2.5em">pattern size <tspan style="font-style: italic">n</tspan></text>
<g transform="translate(36.00 61.20) rotate(-90)"><text x="0" y="0" text-anchor="middle" font-size="11" dy="-2em">time (minutes)</text></g>
<g clip-path="grid">
<path d="M 36.00 115.20 L 58.50 115.20 L 81.00 115.20 L 103.50 115.20 L 126.00 115.20 L 148.50 115.16 L 171.00 114.60 L 193.50 106.44 L 216.00 8.14" fill="transparent" stroke="#c00" stroke-width="2.0"/>
</g>
<text x="193.50" y="25.82" text-anchor="end" dy="0.3em" font-size="11"><tspan style="font-family: 'Inconsolata', monospace">ls</tspan></text>
</svg>

<td width=20>
<td valign=bottom>

<svg width="234pt" height="151pt" viewBox="0 0 234 151"
     xmlns="http://www.w3.org/2000/svg">
<defs>
<clipPath id="grid"><rect x="36.00" y="7.20" width="180.00" height="108.00"/></clipPath></defs>
<path d="M 36.00 115.20 L 36.00 7.20 M 36.00 115.20 L 216.00 115.20 M 36.00 115.20 L 36.00 120.20 M 45.00 115.20 L 45.00 118.20 M 54.00 115.20 L 54.00 120.20 M 63.00 115.20 L 63.00 118.20 M 72.00 115.20 L 72.00 120.20 M 81.00 115.20 L 81.00 118.20 M 90.00 115.20 L 90.00 120.20 M 99.00 115.20 L 99.00 118.20 M 108.00 115.20 L 108.00 120.20 M 117.00 115.20 L 117.00 118.20 M 126.00 115.20 L 126.00 120.20 M 135.00 115.20 L 135.00 118.20 M 144.00 115.20 L 144.00 120.20 M 153.00 115.20 L 153.00 118.20 M 162.00 115.20 L 162.00 120.20 M 171.00 115.20 L 171.00 118.20 M 180.00 115.20 L 180.00 120.20 M 189.00 115.20 L 189.00 118.20 M 198.00 115.20 L 198.00 120.20 M 207.00 115.20 L 207.00 118.20 M 216.00 115.20 L 216.00 120.20 M 36.00 115.20 L 31.00 115.20 M 36.00 100.30 L 31.00 100.30 M 36.00 85.41 L 31.00 85.41 M 36.00 70.51 L 31.00 70.51 M 36.00 55.61 L 31.00 55.61 M 36.00 40.72 L 31.00 40.72 M 36.00 25.82 L 31.00 25.82 M 36.00 10.92 L 31.00 10.92 " fill="transparent" stroke="black"/>
<text x="36.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">0</text>
<text x="54.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">10</text>
<text x="72.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">20</text>
<text x="90.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">30</text>
<text x="108.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">40</text>
<text x="126.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">50</text>
<text x="144.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">60</text>
<text x="162.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">70</text>
<text x="180.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">80</text>
<text x="198.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">90</text>
<text x="216.00" y="120.20" dy="1em" text-anchor="middle" font-size="10">100</text>
<text x="31.00" y="115.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">0</text>
<text x="31.00" y="100.30" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1</text>
<text x="31.00" y="85.41" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">2</text>
<text x="31.00" y="70.51" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">3</text>
<text x="31.00" y="55.61" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">4</text>
<text x="31.00" y="40.72" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">5</text>
<text x="31.00" y="25.82" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">6</text>
<text x="31.00" y="10.92" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">7</text>
<text x="126.00" y="115.20" text-anchor="middle" font-size="11" dy="2.5em">pattern size <tspan style="font-style: italic">n</tspan></text>
<g transform="translate(36.00 61.20) rotate(-90)"><text x="0" y="0" text-anchor="middle" font-size="11" dy="-2em">time (ms)</text></g>
<g clip-path="grid">
<path d="M 36.00 93.76 L 37.80 93.21 L 39.60 93.10 L 41.40 92.93 L 43.20 92.66 L 45.00 92.50 L 46.80 92.28 L 48.60 92.03 L 50.40 91.81 L 52.20 91.62 L 54.00 91.35 L 55.80 91.06 L 57.60 90.90 L 59.40 90.74 L 61.20 90.32 L 63.00 90.05 L 64.80 89.95 L 66.60 89.57 L 68.40 89.44 L 70.20 89.05 L 72.00 88.75 L 73.80 88.46 L 75.60 87.87 L 77.40 87.59 L 79.20 87.39 L 81.00 87.12 L 82.80 86.91 L 84.60 86.52 L 86.40 86.22 L 88.20 85.47 L 90.00 85.26 L 91.80 85.04 L 93.60 84.61 L 95.40 84.28 L 97.20 83.87 L 99.00 83.38 L 100.80 83.05 L 102.60 82.74 L 104.40 82.29 L 106.20 81.94 L 108.00 81.48 L 109.80 81.22 L 111.60 80.53 L 113.40 80.13 L 115.20 79.52 L 117.00 79.08 L 118.80 78.61 L 120.60 78.38 L 122.40 77.72 L 124.20 77.39 L 126.00 76.75 L 127.80 76.17 L 129.60 75.98 L 131.40 75.30 L 133.20 74.48 L 135.00 74.34 L 136.80 73.88 L 138.60 73.28 L 140.40 72.81 L 142.20 71.83 L 144.00 71.47 L 145.80 70.95 L 147.60 70.50 L 149.40 69.91 L 151.20 69.51 L 153.00 68.55 L 154.80 68.14 L 156.60 67.31 L 158.40 66.57 L 160.20 66.20 L 162.00 65.24 L 163.80 64.83 L 165.60 64.31 L 167.40 63.50 L 169.20 62.77 L 171.00 62.13 L 172.80 61.15 L 174.60 60.63 L 176.40 60.05 L 178.20 58.81 L 180.00 58.23 L 181.80 57.39 L 183.60 56.55 L 185.40 56.37 L 187.20 54.85 L 189.00 54.50 L 190.80 53.73 L 192.60 52.84 L 194.40 52.14 L 196.20 50.94 L 198.00 50.67 L 199.80 49.73 L 201.60 49.34 L 203.40 48.32 L 205.20 47.57 L 207.00 46.87 L 208.80 45.99 L 210.60 44.91 L 212.40 44.19 L 214.20 43.28" fill="transparent" stroke="#00f" stroke-width="2.0"/>
</g>
<text x="193.50" y="25.82" text-anchor="end" dy="0.3em" font-size="11"><tspan style="font-family: 'Inconsolata', monospace">ls | grep</tspan></text>
</svg>

</table>
</center>
</div>

<p class=lp>For <i>n</i>&nbsp;=&nbsp;8, <code>ls</code> takes 7.19 minutes while <code>ls</code> <code>|</code> <code>grep</code> runs in 1.56 milliseconds,
making it 276,538X faster.
If you&rsquo;ve read my 2007 article “<a href="https://swtch.com/~rsc/regexp/regexp1.html">Regular Expression Matching Can Be Simple And Fast (but is slow in Java, Perl, PHP, Python, Ruby, &hellip;)</a>,”
those graphs may look familiar.
Clearly the <code>ls</code> command is using an exponential pattern-matching algorithm,
while the <code>ls</code> <code>|</code> <code>grep</code> command is using a nearly linear one.</p>

<h2>Shells</h2>

<p class=lp>In fact it&rsquo;s the shell that evaluates the <a href="https://en.wikipedia.org/wiki/Glob_%28programming%29">glob pattern</a> in the first command, not <code>ls</code>,
so let&rsquo;s repeat the experiment with a variety of shells.
All the tests were run on an HP Z440 workstation with 3.5 GHz Intel Xeon E5-1650 v3 processors
running Ubuntu 14.04.</p>

<div class=fig>
<center>
<table cellspacing=0 cellpadding=0 border=0><tr><td>
<div class=box>
<center>
<b>Time to match
(<code>a*</code>)<sup><i>n</i></sup><code>b</code>
against 
<code>a</code><sup>100</sup> in shells</b>
<br>

<svg width="540pt" height="295pt" viewBox="0 0 540 295"
     xmlns="http://www.w3.org/2000/svg">
<defs>
<clipPath id="grid"><rect x="54.00" y="7.20" width="378.00" height="252.00"/></clipPath></defs>
<path d="M 54.00 259.20 L 54.00 7.20 M 54.00 259.20 L 432.00 259.20 M 54.00 259.20 L 54.00 264.20 M 72.90 259.20 L 72.90 262.20 M 91.80 259.20 L 91.80 262.20 M 110.70 259.20 L 110.70 262.20 M 129.60 259.20 L 129.60 262.20 M 148.50 259.20 L 148.50 264.20 M 167.40 259.20 L 167.40 262.20 M 186.30 259.20 L 186.30 262.20 M 205.20 259.20 L 205.20 262.20 M 224.10 259.20 L 224.10 262.20 M 243.00 259.20 L 243.00 264.20 M 261.90 259.20 L 261.90 262.20 M 280.80 259.20 L 280.80 262.20 M 299.70 259.20 L 299.70 262.20 M 318.60 259.20 L 318.60 262.20 M 337.50 259.20 L 337.50 264.20 M 356.40 259.20 L 356.40 262.20 M 375.30 259.20 L 375.30 262.20 M 394.20 259.20 L 394.20 262.20 M 413.10 259.20 L 413.10 262.20 M 432.00 259.20 L 432.00 264.20 M 54.00 10.11 L 51.00 10.11 M 54.00 19.14 L 49.00 19.14 M 54.00 20.51 L 51.00 20.51 M 54.00 22.05 L 51.00 22.05 M 54.00 23.79 L 51.00 23.79 M 54.00 25.80 L 51.00 25.80 M 54.00 28.17 L 51.00 28.17 M 54.00 31.08 L 51.00 31.08 M 54.00 34.83 L 51.00 34.83 M 54.00 40.12 L 51.00 40.12 M 54.00 49.15 L 49.00 49.15 M 54.00 50.52 L 51.00 50.52 M 54.00 52.06 L 51.00 52.06 M 54.00 53.80 L 51.00 53.80 M 54.00 55.81 L 51.00 55.81 M 54.00 58.18 L 51.00 58.18 M 54.00 61.09 L 51.00 61.09 M 54.00 64.84 L 51.00 64.84 M 54.00 70.12 L 51.00 70.12 M 54.00 79.16 L 49.00 79.16 M 54.00 80.53 L 51.00 80.53 M 54.00 82.06 L 51.00 82.06 M 54.00 83.80 L 51.00 83.80 M 54.00 85.81 L 51.00 85.81 M 54.00 88.19 L 51.00 88.19 M 54.00 91.10 L 51.00 91.10 M 54.00 94.85 L 51.00 94.85 M 54.00 100.13 L 51.00 100.13 M 54.00 109.16 L 49.00 109.16 M 54.00 110.54 L 51.00 110.54 M 54.00 112.07 L 51.00 112.07 M 54.00 113.81 L 51.00 113.81 M 54.00 115.82 L 51.00 115.82 M 54.00 118.20 L 51.00 118.20 M 54.00 121.10 L 51.00 121.10 M 54.00 124.85 L 51.00 124.85 M 54.00 130.14 L 51.00 130.14 M 54.00 139.17 L 49.00 139.17 M 54.00 140.54 L 51.00 140.54 M 54.00 142.08 L 51.00 142.08 M 54.00 143.82 L 51.00 143.82 M 54.00 145.83 L 51.00 145.83 M 54.00 148.20 L 51.00 148.20 M 54.00 151.11 L 51.00 151.11 M 54.00 154.86 L 51.00 154.86 M 54.00 160.14 L 51.00 160.14 M 54.00 169.18 L 49.00 169.18 M 54.00 170.55 L 51.00 170.55 M 54.00 172.09 L 51.00 172.09 M 54.00 173.83 L 51.00 173.83 M 54.00 175.84 L 51.00 175.84 M 54.00 178.21 L 51.00 178.21 M 54.00 181.12 L 51.00 181.12 M 54.00 184.87 L 51.00 184.87 M 54.00 190.15 L 51.00 190.15 M 54.00 199.19 L 49.00 199.19 M 54.00 200.56 L 51.00 200.56 M 54.00 202.09 L 51.00 202.09 M 54.00 203.83 L 51.00 203.83 M 54.00 205.84 L 51.00 205.84 M 54.00 208.22 L 51.00 208.22 M 54.00 211.13 L 51.00 211.13 M 54.00 214.88 L 51.00 214.88 M 54.00 220.16 L 51.00 220.16 M 54.00 229.19 L 49.00 229.19 M 54.00 230.57 L 51.00 230.57 M 54.00 232.10 L 51.00 232.10 M 54.00 233.84 L 51.00 233.84 M 54.00 235.85 L 51.00 235.85 M 54.00 238.23 L 51.00 238.23 M 54.00 241.13 L 51.00 241.13 M 54.00 244.88 L 51.00 244.88 M 54.00 250.17 L 51.00 250.17 M 54.00 259.20 L 49.00 259.20 " fill="transparent" stroke="black"/>
<text x="54.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">0</text>
<text x="148.50" y="264.20" dy="1em" text-anchor="middle" font-size="10">5</text>
<text x="243.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">10</text>
<text x="337.50" y="264.20" dy="1em" text-anchor="middle" font-size="10">15</text>
<text x="432.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">20</text>
<text x="49.00" y="19.14" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10000 s</text>
<text x="49.00" y="49.15" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1000 s</text>
<text x="49.00" y="79.16" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 s</text>
<text x="49.00" y="109.16" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 s</text>
<text x="49.00" y="139.17" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1 s</text>
<text x="49.00" y="169.18" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 ms</text>
<text x="49.00" y="199.19" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 ms</text>
<text x="49.00" y="229.19" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1 ms</text>
<text x="49.00" y="259.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 us</text>
<text x="243.00" y="259.20" text-anchor="middle" font-size="11" dy="2.5em">pattern size <tspan style="font-style: italic">n</tspan></text>
<g transform="translate(54.00 133.20) rotate(-90)"><text x="0" y="0" text-anchor="middle" font-size="11" dy="-4em">time</text></g>
<g clip-path="grid">
<path d="M 54.00 209.74 L 72.90 204.94 L 91.80 207.77 L 110.70 186.36 L 129.60 148.18 L 148.50 110.51 L 167.40 74.52 L 186.30 40.43 L 205.20 8.32" fill="transparent" stroke="#F44336" stroke-width="1.5"/>
<path d="M 54.00 228.55 L 72.90 231.02 L 91.80 229.51 L 110.70 216.70 L 129.60 179.56 L 148.50 142.02 L 167.40 105.84 L 186.30 71.66 L 205.20 38.81" fill="transparent" stroke="#FF9800" stroke-width="1.5"/>
<path d="M 54.00 218.88 L 72.90 211.48 L 91.80 213.08 L 110.70 201.35 L 129.60 181.70 L 148.50 147.79 L 167.40 112.18 L 186.30 77.89 L 205.20 45.59" fill="transparent" stroke="#FFEB3B" stroke-width="1.5"/>
<path d="M 54.00 219.59 L 72.90 211.30 L 91.80 211.19 L 110.70 206.74 L 129.60 190.17 L 148.50 153.89 L 167.40 117.20 L 186.30 82.26 L 205.20 49.22" fill="transparent" stroke="#00BCD4" stroke-width="1.5"/>
<path d="M 54.00 222.14 L 72.90 223.88 L 91.80 225.22 L 110.70 214.51 L 129.60 190.20 L 148.50 158.35 L 167.40 122.14 L 186.30 88.07 L 205.20 55.77" fill="transparent" stroke="#4CAF50" stroke-width="1.5"/>
<path d="M 54.00 221.94 L 72.90 221.31 L 91.80 219.68 L 110.70 215.59 L 129.60 196.91 L 148.50 164.89 L 167.40 127.97 L 186.30 93.09 L 205.20 60.02" fill="transparent" stroke="#009688" stroke-width="1.5"/>
<path d="M 54.00 232.71 L 72.90 236.88 L 91.80 237.09 L 110.70 234.49 L 129.60 211.28 L 148.50 173.90 L 167.40 138.01 L 186.30 103.73 L 205.20 71.05" fill="transparent" stroke="#2196F3" stroke-width="1.5"/>
<path d="M 54.00 189.23 L 72.90 189.77 L 91.80 189.62 L 110.70 185.52 L 129.60 189.65 L 148.50 189.85 L 167.40 189.90 L 186.30 189.66 L 205.20 189.65 L 224.10 189.76 L 243.00 189.53 L 261.90 188.03 L 280.80 183.99 L 299.70 189.74 L 318.60 185.46 L 337.50 189.86 L 356.40 189.72 L 375.30 185.15 L 394.20 189.75 L 413.10 189.65 L 432.00 184.47" fill="transparent" stroke="#9C27B0" stroke-width="1.5"/>
</g>
<path d=" M 223.20 8.32 L 241.20 8.32" fill="transparent" stroke="#F44336" stroke-width="1.5"/>
<text x="245.70" y="8.32" dy="0.3em" font-size="9">tcsh 6.18.01</text>
<path d=" M 223.20 31.08 L 241.20 31.08" fill="transparent" stroke="#FF9800" stroke-width="1.5"/>
<text x="245.70" y="31.08" dy="0.3em" font-size="9">ksh 93u+20120801</text>
<path d=" M 223.20 40.12 L 241.20 40.12" fill="transparent" stroke="#FFEB3B" stroke-width="1.5"/>
<text x="245.70" y="40.12" dy="0.3em" font-size="9">Plan 9 rc</text>
<path d=" M 223.20 49.15 L 241.20 49.15" fill="transparent" stroke="#00BCD4" stroke-width="1.5"/>
<text x="245.70" y="49.15" dy="0.3em" font-size="9">zsh 5.0.5</text>
<path d=" M 223.20 58.18 L 241.20 58.18" fill="transparent" stroke="#4CAF50" stroke-width="1.5"/>
<text x="245.70" y="58.18" dy="0.3em" font-size="9">rc 1.7.1</text>
<path d=" M 223.20 67.21 L 241.20 67.21" fill="transparent" stroke="#009688" stroke-width="1.5"/>
<text x="245.70" y="67.21" dy="0.3em" font-size="9">bash 4.3</text>
<path d=" M 223.20 76.25 L 241.20 76.25" fill="transparent" stroke="#2196F3" stroke-width="1.5"/>
<text x="245.70" y="76.25" dy="0.3em" font-size="9">dash 0.5.7</text>
<path d=" M 450.00 184.47 L 468.00 184.47" fill="transparent" stroke="#9C27B0" stroke-width="1.5"/>
<text x="472.50" y="184.47" dy="0.3em" font-size="9">csh 20110502</text>
</svg>

</center>
</div>
</table>
</center>
</div>

<p class=lp>Basically, the same thing is going on here as in my regular expression article:
backtracking was an obvious implementation strategy, so most implementations use it,
causing the performance cliffs.</p>

<p class=pp>The exception seems to be the original Berkeley csh, which runs in linear time (more precisely, time linear in <em>n</em>).
Looking at the source code, it doesn&rsquo;t attempt to perform glob expansion itself.
Instead it calls the C library implementation <a href="https://linux.die.net/man/3/glob"><em>glob</em>(3)</a>,
which runs in linear time, at least on this Linux system.
So maybe we should look at programming language implementations too.</p>

<h2>Programming Languages</h2>

<p class=lp>Most programming languages provide some kind of glob expansion,
like C&rsquo;s <code>glob</code>.
Let&rsquo;s repeat the experiment in a variety of different programming languages:</p>

<div class=fig>
<center>
<table cellspacing=0 cellpadding=0 border=0><tr><td>
<div class=box>
<center>
<b>Time to match
(<code>a*</code>)<sup><i>n</i></sup><code>b</code>
against 
<code>a</code><sup>100</sup> in programming languages</b>
<br>

<svg width="540pt" height="295pt" viewBox="0 0 540 295"
     xmlns="http://www.w3.org/2000/svg">
<defs>
<clipPath id="grid"><rect x="54.00" y="7.20" width="378.00" height="252.00"/></clipPath></defs>
<path d="M 54.00 259.20 L 54.00 7.20 M 54.00 259.20 L 432.00 259.20 M 54.00 259.20 L 54.00 264.20 M 72.90 259.20 L 72.90 262.20 M 91.80 259.20 L 91.80 262.20 M 110.70 259.20 L 110.70 262.20 M 129.60 259.20 L 129.60 262.20 M 148.50 259.20 L 148.50 264.20 M 167.40 259.20 L 167.40 262.20 M 186.30 259.20 L 186.30 262.20 M 205.20 259.20 L 205.20 262.20 M 224.10 259.20 L 224.10 262.20 M 243.00 259.20 L 243.00 264.20 M 261.90 259.20 L 261.90 262.20 M 280.80 259.20 L 280.80 262.20 M 299.70 259.20 L 299.70 262.20 M 318.60 259.20 L 318.60 262.20 M 337.50 259.20 L 337.50 264.20 M 356.40 259.20 L 356.40 262.20 M 375.30 259.20 L 375.30 262.20 M 394.20 259.20 L 394.20 262.20 M 413.10 259.20 L 413.10 262.20 M 432.00 259.20 L 432.00 264.20 M 54.00 7.20 L 51.00 7.20 M 54.00 14.92 L 49.00 14.92 M 54.00 16.10 L 51.00 16.10 M 54.00 17.41 L 51.00 17.41 M 54.00 18.90 L 51.00 18.90 M 54.00 20.61 L 51.00 20.61 M 54.00 22.64 L 51.00 22.64 M 54.00 25.13 L 51.00 25.13 M 54.00 28.33 L 51.00 28.33 M 54.00 32.85 L 51.00 32.85 M 54.00 40.57 L 49.00 40.57 M 54.00 41.75 L 51.00 41.75 M 54.00 43.06 L 51.00 43.06 M 54.00 44.55 L 51.00 44.55 M 54.00 46.26 L 51.00 46.26 M 54.00 48.30 L 51.00 48.30 M 54.00 50.78 L 51.00 50.78 M 54.00 53.99 L 51.00 53.99 M 54.00 58.50 L 51.00 58.50 M 54.00 66.23 L 49.00 66.23 M 54.00 67.40 L 51.00 67.40 M 54.00 68.71 L 51.00 68.71 M 54.00 70.20 L 51.00 70.20 M 54.00 71.92 L 51.00 71.92 M 54.00 73.95 L 51.00 73.95 M 54.00 76.43 L 51.00 76.43 M 54.00 79.64 L 51.00 79.64 M 54.00 84.16 L 51.00 84.16 M 54.00 91.88 L 49.00 91.88 M 54.00 93.05 L 51.00 93.05 M 54.00 94.36 L 51.00 94.36 M 54.00 95.85 L 51.00 95.85 M 54.00 97.57 L 51.00 97.57 M 54.00 99.60 L 51.00 99.60 M 54.00 102.08 L 51.00 102.08 M 54.00 105.29 L 51.00 105.29 M 54.00 109.81 L 51.00 109.81 M 54.00 117.53 L 49.00 117.53 M 54.00 118.70 L 51.00 118.70 M 54.00 120.01 L 51.00 120.01 M 54.00 121.50 L 51.00 121.50 M 54.00 123.22 L 51.00 123.22 M 54.00 125.25 L 51.00 125.25 M 54.00 127.74 L 51.00 127.74 M 54.00 130.94 L 51.00 130.94 M 54.00 135.46 L 51.00 135.46 M 54.00 143.18 L 49.00 143.18 M 54.00 144.35 L 51.00 144.35 M 54.00 145.67 L 51.00 145.67 M 54.00 147.15 L 51.00 147.15 M 54.00 148.87 L 51.00 148.87 M 54.00 150.90 L 51.00 150.90 M 54.00 153.39 L 51.00 153.39 M 54.00 156.59 L 51.00 156.59 M 54.00 161.11 L 51.00 161.11 M 54.00 168.83 L 49.00 168.83 M 54.00 170.01 L 51.00 170.01 M 54.00 171.32 L 51.00 171.32 M 54.00 172.81 L 51.00 172.81 M 54.00 174.52 L 51.00 174.52 M 54.00 176.55 L 51.00 176.55 M 54.00 179.04 L 51.00 179.04 M 54.00 182.24 L 51.00 182.24 M 54.00 186.76 L 51.00 186.76 M 54.00 194.48 L 49.00 194.48 M 54.00 195.66 L 51.00 195.66 M 54.00 196.97 L 51.00 196.97 M 54.00 198.46 L 51.00 198.46 M 54.00 200.17 L 51.00 200.17 M 54.00 202.21 L 51.00 202.21 M 54.00 204.69 L 51.00 204.69 M 54.00 207.90 L 51.00 207.90 M 54.00 212.41 L 51.00 212.41 M 54.00 220.14 L 49.00 220.14 M 54.00 221.31 L 51.00 221.31 M 54.00 222.62 L 51.00 222.62 M 54.00 224.11 L 51.00 224.11 M 54.00 225.83 L 51.00 225.83 M 54.00 227.86 L 51.00 227.86 M 54.00 230.34 L 51.00 230.34 M 54.00 233.55 L 51.00 233.55 M 54.00 238.07 L 51.00 238.07 M 54.00 245.79 L 49.00 245.79 M 54.00 246.96 L 51.00 246.96 M 54.00 248.27 L 51.00 248.27 M 54.00 249.76 L 51.00 249.76 M 54.00 251.48 L 51.00 251.48 M 54.00 253.51 L 51.00 253.51 M 54.00 256.00 L 51.00 256.00 M 54.00 259.20 L 51.00 259.20 " fill="transparent" stroke="black"/>
<text x="54.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">0</text>
<text x="148.50" y="264.20" dy="1em" text-anchor="middle" font-size="10">5</text>
<text x="243.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">10</text>
<text x="337.50" y="264.20" dy="1em" text-anchor="middle" font-size="10">15</text>
<text x="432.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">20</text>
<text x="49.00" y="14.92" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1000 s</text>
<text x="49.00" y="40.57" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 s</text>
<text x="49.00" y="66.23" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 s</text>
<text x="49.00" y="91.88" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1 s</text>
<text x="49.00" y="117.53" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 ms</text>
<text x="49.00" y="143.18" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 ms</text>
<text x="49.00" y="168.83" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1 ms</text>
<text x="49.00" y="194.48" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 us</text>
<text x="49.00" y="220.14" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 us</text>
<text x="49.00" y="245.79" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1 us</text>
<text x="243.00" y="259.20" text-anchor="middle" font-size="11" dy="2.5em">pattern size <tspan style="font-style: italic">n</tspan></text>
<g transform="translate(54.00 133.20) rotate(-90)"><text x="0" y="0" text-anchor="middle" font-size="11" dy="-4em">time</text></g>
<g clip-path="grid">
<path d="M 54.00 199.28 L 72.90 198.88 L 91.80 180.38 L 110.70 166.57 L 129.60 127.45 L 148.50 99.11 L 167.40 64.53 L 186.30 39.64 L 205.20 8.22" fill="transparent" stroke="#F44336" stroke-width="1.5"/>
<path d="M 54.00 238.18 L 72.90 225.21 L 91.80 207.56 L 110.70 170.02 L 129.60 134.58 L 148.50 101.56 L 167.40 70.56 L 186.30 41.42 L 205.20 13.88" fill="transparent" stroke="#FF9800" stroke-width="1.5"/>
<path d="M 54.00 243.95 L 72.90 217.33 L 91.80 199.58 L 110.70 164.53 L 129.60 133.23 L 148.50 101.68 L 167.40 71.58 L 186.30 42.42 L 205.20 14.93" fill="transparent" stroke="#FFEB3B" stroke-width="1.5"/>
<path d="M 54.00 217.56 L 72.90 200.27 L 91.80 198.54 L 110.70 175.66 L 129.60 143.12 L 148.50 113.77 L 167.40 84.33 L 186.30 54.80 L 205.20 26.60" fill="transparent" stroke="#777" stroke-width="1.5"/>
<path d="M 54.00 220.14 L 72.90 216.39 L 91.80 213.59 L 110.70 187.22 L 129.60 151.20 L 148.50 117.16 L 167.40 85.65 L 186.30 56.06 L 205.20 27.81" fill="transparent" stroke="#00BCD4" stroke-width="1.5"/>
<path d="M 54.00 231.33 L 72.90 216.61 L 91.80 216.30 L 110.70 215.97 L 129.60 216.69 L 148.50 216.57 L 167.40 216.52 L 186.30 216.49 L 205.20 216.21 L 224.10 216.19 L 243.00 216.33 L 261.90 216.14 L 280.80 216.57 L 299.70 216.77 L 318.60 215.66 L 337.50 216.67 L 356.40 216.46 L 375.30 216.33 L 394.20 216.29 L 413.10 216.19 L 432.00 215.89" fill="transparent" stroke="#4CAF50" stroke-width="1.5"/>
<path d="M 54.00 244.21 L 72.90 222.69 L 91.80 224.13 L 110.70 221.83 L 129.60 225.78 L 148.50 223.57 L 167.40 225.98 L 186.30 224.86 L 205.20 222.34 L 224.10 224.67 L 243.00 224.90 L 261.90 224.93 L 280.80 223.76 L 299.70 223.15 L 318.60 224.17 L 337.50 221.86 L 356.40 222.38 L 375.30 223.44 L 394.20 224.03 L 413.10 224.84 L 432.00 222.80" fill="transparent" stroke="#009688" stroke-width="1.5"/>
<path d="M 54.00 244.32 L 72.90 228.52 L 91.80 228.52 L 110.70 228.52 L 129.60 228.47 L 148.50 228.39 L 167.40 228.26 L 186.30 228.22 L 205.20 228.12 L 224.10 228.03 L 243.00 228.07 L 261.90 227.98 L 280.80 227.72 L 299.70 227.67 L 318.60 227.70 L 337.50 227.69 L 356.40 227.60 L 375.30 227.57 L 394.20 227.58 L 413.10 227.50 L 432.00 227.16" fill="transparent" stroke="#2196F3" stroke-width="1.5"/>
<path d="M 54.00 257.36 L 72.90 235.51 L 91.80 235.49 L 110.70 235.30 L 129.60 235.25 L 148.50 235.12 L 167.40 235.03 L 186.30 234.91 L 205.20 234.81 L 224.10 234.77 L 243.00 234.75 L 261.90 234.53 L 280.80 234.59 L 299.70 234.51 L 318.60 234.33 L 337.50 234.27 L 356.40 234.26 L 375.30 234.19 L 394.20 234.03 L 413.10 233.72 L 432.00 233.98" fill="transparent" stroke="#9C27B0" stroke-width="1.5"/>
</g>
<path d=" M 223.20 8.22 L 241.20 8.22" fill="transparent" stroke="#F44336" stroke-width="1.5"/>
<text x="245.70" y="8.22" dy="0.3em" font-size="9">Java 8</text>
<path d=" M 223.20 17.00 L 241.20 17.00" fill="transparent" stroke="#FF9800" stroke-width="1.5"/>
<text x="245.70" y="17.00" dy="0.3em" font-size="9">Perl 5.18.2</text>
<path d=" M 223.20 25.79 L 241.20 25.79" fill="transparent" stroke="#FFEB3B" stroke-width="1.5"/>
<text x="245.70" y="25.79" dy="0.3em" font-size="9">BSD libc</text>
<path d=" M 223.20 34.57 L 241.20 34.57" fill="transparent" stroke="#777" stroke-width="1.5"/>
<text x="245.70" y="34.57" dy="0.3em" font-size="9">Python 3.4.3</text>
<path d=" M 223.20 43.36 L 241.20 43.36" fill="transparent" stroke="#00BCD4" stroke-width="1.5"/>
<text x="245.70" y="43.36" dy="0.3em" font-size="9">Tcl 8.6.1</text>
<path d=" M 450.00 211.52 L 468.00 211.52" fill="transparent" stroke="#4CAF50" stroke-width="1.5"/>
<text x="472.50" y="211.52" dy="0.3em" font-size="9">Rust 1.16.0</text>
<path d=" M 450.00 220.30 L 468.00 220.30" fill="transparent" stroke="#009688" stroke-width="1.5"/>
<text x="472.50" y="220.30" dy="0.3em" font-size="9">Go 1.8</text>
<path d=" M 450.00 229.09 L 468.00 229.09" fill="transparent" stroke="#2196F3" stroke-width="1.5"/>
<text x="472.50" y="229.09" dy="0.3em" font-size="9">Ruby 1.9.3</text>
<path d=" M 450.00 237.87 L 468.00 237.87" fill="transparent" stroke="#9C27B0" stroke-width="1.5"/>
<text x="472.50" y="237.87" dy="0.3em" font-size="9">glibc 2.19</text>
</svg>

</center>
</div>
</table>
</center>
</div>

<p class=lp>Perhaps the most interesting fact evident in the graph
is that GNU glibc, the C library used on Linux systems,
has a linear-time <code>glob</code> implementation, but
BSD libc, the C library used on BSD and macOS systems,
has an exponential-time implementation.</p>

<p class=pp>PHP is not shown in the graph, because its
<a href="http://php.net/manual/en/function.glob.php">glob function</a> simply invokes
the host C library&rsquo;s <em>glob</em>(3),
so that it runs in linear time on Linux
and in exponential time on non-Linux systems.
(I have not tested what happens on Windows.)
All the languages shown in the graph, however,
implement glob matching without using the host C library,
so the results should not vary by host operating system.</p>

<h2>FTP Servers</h2>

<p class=lp>It&rsquo;s not just shells and programming languages that implement glob matching.
Although not mandated by the <a href="https://tools.ietf.org/html/rfc959">FTP RFC</a>,
most FTP servers allow glob patterns as the argument to commands
like LIST and STAT.
Let&rsquo;s repeat the experiment with a variety of FTP server implementations:</p>

<div class=fig>
<center>
<table cellspacing=0 cellpadding=0 border=0><tr><td>
<div class=box>
<center>
<b>Time to match
(<code>a*</code>)<sup><i>n</i></sup><code>b</code>
against 
<code>a</code><sup>100</sup> in FTP servers</b>
<br>

<svg width="540pt" height="295pt" viewBox="0 0 540 295"
     xmlns="http://www.w3.org/2000/svg">
<defs>
<clipPath id="grid"><rect x="54.00" y="7.20" width="378.00" height="252.00"/></clipPath></defs>
<path d="M 54.00 259.20 L 54.00 7.20 M 54.00 259.20 L 432.00 259.20 M 54.00 259.20 L 54.00 264.20 M 72.90 259.20 L 72.90 262.20 M 91.80 259.20 L 91.80 262.20 M 110.70 259.20 L 110.70 262.20 M 129.60 259.20 L 129.60 262.20 M 148.50 259.20 L 148.50 264.20 M 167.40 259.20 L 167.40 262.20 M 186.30 259.20 L 186.30 262.20 M 205.20 259.20 L 205.20 262.20 M 224.10 259.20 L 224.10 262.20 M 243.00 259.20 L 243.00 264.20 M 261.90 259.20 L 261.90 262.20 M 280.80 259.20 L 280.80 262.20 M 299.70 259.20 L 299.70 262.20 M 318.60 259.20 L 318.60 262.20 M 337.50 259.20 L 337.50 264.20 M 356.40 259.20 L 356.40 262.20 M 375.30 259.20 L 375.30 262.20 M 394.20 259.20 L 394.20 262.20 M 413.10 259.20 L 413.10 262.20 M 432.00 259.20 L 432.00 264.20 M 54.00 7.20 L 49.00 7.20 M 54.00 8.64 L 51.00 8.64 M 54.00 10.25 L 51.00 10.25 M 54.00 12.08 L 51.00 12.08 M 54.00 14.19 L 51.00 14.19 M 54.00 16.68 L 51.00 16.68 M 54.00 19.74 L 51.00 19.74 M 54.00 23.67 L 51.00 23.67 M 54.00 29.22 L 51.00 29.22 M 54.00 38.70 L 49.00 38.70 M 54.00 40.14 L 51.00 40.14 M 54.00 41.75 L 51.00 41.75 M 54.00 43.58 L 51.00 43.58 M 54.00 45.69 L 51.00 45.69 M 54.00 48.18 L 51.00 48.18 M 54.00 51.24 L 51.00 51.24 M 54.00 55.17 L 51.00 55.17 M 54.00 60.72 L 51.00 60.72 M 54.00 70.20 L 49.00 70.20 M 54.00 71.64 L 51.00 71.64 M 54.00 73.25 L 51.00 73.25 M 54.00 75.08 L 51.00 75.08 M 54.00 77.19 L 51.00 77.19 M 54.00 79.68 L 51.00 79.68 M 54.00 82.74 L 51.00 82.74 M 54.00 86.67 L 51.00 86.67 M 54.00 92.22 L 51.00 92.22 M 54.00 101.70 L 49.00 101.70 M 54.00 103.14 L 51.00 103.14 M 54.00 104.75 L 51.00 104.75 M 54.00 106.58 L 51.00 106.58 M 54.00 108.69 L 51.00 108.69 M 54.00 111.18 L 51.00 111.18 M 54.00 114.24 L 51.00 114.24 M 54.00 118.17 L 51.00 118.17 M 54.00 123.72 L 51.00 123.72 M 54.00 133.20 L 49.00 133.20 M 54.00 134.64 L 51.00 134.64 M 54.00 136.25 L 51.00 136.25 M 54.00 138.08 L 51.00 138.08 M 54.00 140.19 L 51.00 140.19 M 54.00 142.68 L 51.00 142.68 M 54.00 145.74 L 51.00 145.74 M 54.00 149.67 L 51.00 149.67 M 54.00 155.22 L 51.00 155.22 M 54.00 164.70 L 49.00 164.70 M 54.00 166.14 L 51.00 166.14 M 54.00 167.75 L 51.00 167.75 M 54.00 169.58 L 51.00 169.58 M 54.00 171.69 L 51.00 171.69 M 54.00 174.18 L 51.00 174.18 M 54.00 177.24 L 51.00 177.24 M 54.00 181.17 L 51.00 181.17 M 54.00 186.72 L 51.00 186.72 M 54.00 196.20 L 49.00 196.20 M 54.00 197.64 L 51.00 197.64 M 54.00 199.25 L 51.00 199.25 M 54.00 201.08 L 51.00 201.08 M 54.00 203.19 L 51.00 203.19 M 54.00 205.68 L 51.00 205.68 M 54.00 208.74 L 51.00 208.74 M 54.00 212.67 L 51.00 212.67 M 54.00 218.22 L 51.00 218.22 M 54.00 227.70 L 49.00 227.70 M 54.00 229.14 L 51.00 229.14 M 54.00 230.75 L 51.00 230.75 M 54.00 232.58 L 51.00 232.58 M 54.00 234.69 L 51.00 234.69 M 54.00 237.18 L 51.00 237.18 M 54.00 240.24 L 51.00 240.24 M 54.00 244.17 L 51.00 244.17 M 54.00 249.72 L 51.00 249.72 M 54.00 259.20 L 49.00 259.20 " fill="transparent" stroke="black"/>
<text x="54.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">0</text>
<text x="148.50" y="264.20" dy="1em" text-anchor="middle" font-size="10">5</text>
<text x="243.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">10</text>
<text x="337.50" y="264.20" dy="1em" text-anchor="middle" font-size="10">15</text>
<text x="432.00" y="264.20" dy="1em" text-anchor="middle" font-size="10">20</text>
<text x="49.00" y="7.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1000 s</text>
<text x="49.00" y="38.70" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 s</text>
<text x="49.00" y="70.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 s</text>
<text x="49.00" y="101.70" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1 s</text>
<text x="49.00" y="133.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 ms</text>
<text x="49.00" y="164.70" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 ms</text>
<text x="49.00" y="196.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">1 ms</text>
<text x="49.00" y="227.70" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">100 us</text>
<text x="49.00" y="259.20" dx="-0.3em" dy="0.3em" text-anchor="end" font-size="10">10 us</text>
<text x="243.00" y="259.20" text-anchor="middle" font-size="11" dy="2.5em">pattern size <tspan style="font-style: italic">n</tspan></text>
<g transform="translate(54.00 133.20) rotate(-90)"><text x="0" y="0" text-anchor="middle" font-size="11" dy="-4em">time</text></g>
<g clip-path="grid">
<path d="M 54.00 200.58 L 72.90 201.05 L 91.80 201.44 L 110.70 194.06 L 129.60 158.13 L 148.50 119.12 L 167.40 79.33 L 186.30 42.97 L 205.20 8.51" fill="transparent" stroke="#F44336" stroke-width="1.5"/>
<path d="M 54.00 230.95 L 72.90 229.57 L 91.80 225.90 L 110.70 193.96 L 129.60 151.87 L 148.50 111.91 L 167.40 74.74 L 186.30 62.94" fill="transparent" stroke="#FF9800" stroke-width="1.5"/>
<path d="M 54.00 145.74 L 72.90 145.74 L 91.80 145.74 L 110.70 145.72 L 129.60 144.44 L 148.50 145.76 L 167.40 145.70 L 186.30 145.77 L 205.20 145.74 L 224.10 145.73 L 243.00 145.74 L 261.90 145.74 L 280.80 145.74 L 299.70 145.75 L 318.60 145.74 L 337.50 145.74 L 356.40 145.74 L 375.30 145.74 L 394.20 145.76 L 413.10 145.72 L 432.00 145.75" fill="transparent" stroke="#FFEB3B" stroke-width="1.5"/>
<path d="M 54.00 189.28 L 72.90 190.47 L 91.80 191.59 L 110.70 192.80 L 129.60 190.83 L 148.50 192.29 L 167.40 192.73 L 186.30 192.65 L 205.20 192.87 L 224.10 192.42 L 243.00 192.79 L 261.90 192.86 L 280.80 192.32 L 299.70 192.53 L 318.60 192.85 L 337.50 192.69 L 356.40 192.39 L 375.30 192.26 L 394.20 192.67 L 413.10 192.64 L 432.00 192.76" fill="transparent" stroke="#00BCD4" stroke-width="1.5"/>
<path d="M 54.00 219.38 L 72.90 213.45 L 91.80 213.73 L 110.70 213.76 L 129.60 213.99 L 148.50 214.22 L 167.40 213.92 L 186.30 214.14 L 205.20 214.30 L 224.10 214.47 L 243.00 214.49 L 261.90 213.99 L 280.80 214.05 L 299.70 212.30 L 318.60 214.06 L 337.50 214.35 L 356.40 214.39 L 375.30 213.83 L 394.20 208.13 L 413.10 210.43 L 432.00 210.91" fill="transparent" stroke="#4CAF50" stroke-width="1.5"/>
<path d="M 54.00 233.08 L 72.90 234.33 L 91.80 234.97 L 110.70 234.01 L 129.60 236.28 L 148.50 234.73 L 167.40 234.91 L 186.30 235.64 L 205.20 234.76 L 224.10 235.36 L 243.00 235.59 L 261.90 235.18 L 280.80 235.38 L 299.70 235.32 L 318.60 235.52 L 337.50 235.52 L 356.40 235.73 L 375.30 235.24 L 394.20 235.50 L 413.10 235.62 L 432.00 235.29" fill="transparent" stroke="#009688" stroke-width="1.5"/>
</g>
<path d=" M 223.20 8.51 L 241.20 8.51" fill="transparent" stroke="#F44336" stroke-width="1.5"/>
<text x="245.70" y="8.51" dy="0.3em" font-size="9">tnftpd (macOS 10.12.4)</text>
<path d=" M 223.20 62.94 L 241.20 62.94" fill="transparent" stroke="#FF9800" stroke-width="1.5"/>
<text x="245.70" y="62.94" dy="0.3em" font-size="9">Pure-FTPd 1.0.36</text>
<path d=" M 450.00 145.75 L 468.00 145.75" fill="transparent" stroke="#FFEB3B" stroke-width="1.5"/>
<text x="472.50" y="145.75" dy="0.3em" font-size="9">netkit ftpd 0.17</text>
<path d=" M 450.00 192.76 L 468.00 192.76" fill="transparent" stroke="#00BCD4" stroke-width="1.5"/>
<text x="472.50" y="192.76" dy="0.3em" font-size="9">Plan 9 ip/ftpd</text>
<path d=" M 450.00 210.91 L 468.00 210.91" fill="transparent" stroke="#4CAF50" stroke-width="1.5"/>
<text x="472.50" y="210.91" dy="0.3em" font-size="9">ProFTPD 1.3.5</text>
<path d=" M 450.00 235.29 L 468.00 235.29" fill="transparent" stroke="#009688" stroke-width="1.5"/>
<text x="472.50" y="235.29" dy="0.3em" font-size="9">vsftpd 3.0.2</text>
</svg>

</center>
</div>
</table>
</center>
</div>

<p class=lp>On Linux, Pure-FTPd would probably have run for a hundred or more seconds for <i>n</i>&nbsp;=&nbsp;7,
but instead it died and hung up the connection after 17 seconds.
All the tests were run on the same Linux system as before, except tnftpd, which was run on a mid-2015 MacBook Pro with a 2.8 GHz Intel Core i7 processor running macOS 10.12.4.
On that Mac system, tnftpd
(which can only be enabled using the command-line, so most people don&rsquo;t run it)
has no such time limit:
even if a client times out and hangs up (as the command-line ftp client does after 30 seconds),
the server side still consumes CPU until the full pattern match finishes.</p>

<p class=pp>The netkit ftpd runs quickly on Linux because it relies on the host
C library&rsquo;s <code>glob</code> function.
If run on BSD, the netkit ftpd would take exponential time.
ProFTPD ships a copy of the glibc <code>glob</code>,
so it should run quickly even on BSD systems.
Ironically, Pure-FTPd and tnftpd take exponential time on Linux
because they ship a copy of the BSD <code>glob</code> function.
Presumably they do this to avoid assuming that the host C library is bug-free,
but, at least in this one case,
the host C library is better than the one they ship.</p>

<p class=pp>Obviously not many servers have a file named <code>a</code><sup>100</sup>,
but the pattern can be adapted to shorter, less unusual names.
This gives a denial of service attack against some anonymous FTP servers.
It appears that tnftpd is derived from the standard FreeBSD ftpd,
so BSD systems may be affected as well.</p>

<p class=pp>FTP servers and C libraries
have a <a href="http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=glob">long history of problems with glob patterns</a>,
including buffer and heap overflows causing crashes or even remote code execution.
But here let&rsquo;s focus on CPU exhaustion issues around pattern matching.</p>

<p class=pp>In 2001, <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1501">CVE-2001-1501</a> was issued for a <a href="http://marc.info/?l=bugtraq&amp;m=98477291420305&amp;w=2">vulnerability in ProFTPD 1.2.1</a>, because it could run for a very long time finding and recording the very many matches for a pattern like:</p>

<pre><code>ls */../*/../*/../*/../*/../*/../*/../*/../*/../*
</code></pre>

<p class=lp>In response, most <code>glob</code> implementations <a href="https://github.com/openbsd/src/commit/98e1217625a0">added a <code>GLOB_LIMIT</code> flag</a> that can be used to limit the number of matches returned, controlling both the CPU and the memory usage for such a pattern.</p>

<p class=pp>Unfortunately, a pattern like that can cause a lot of effort without finding any matches.
In 2010, <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2632">CVE-2010-2632</a> was issued for a <a href="http://cxsecurity.com/issue/WLB-2010100135">variant with no matches</a>:</p>

<pre><code>ls */../*/../*/../*/../*/../*/../*/../*/../*blablahaha
</code></pre>

<p class=lp>In response, most <code>glob</code> implementations <a href="https://github.com/openbsd/src/commit/46df4fe576b7">expanded <code>GLOB_LIMIT</code></a> to count directory read and file stat operations in addition to matches.</p>

<p class=pp>In 2015, <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5917">CVE-2015-5917</a> was issued for <a href="https://cxsecurity.com/issue/WLB-2013040082">the same vulnerability in OS X 10.10.5&rsquo;s FTP server</a> (reported in 2013), which had its own copy of the <code>glob</code> implementation and had not been patched in 2010.
There have also been similar problems around FTP servers implementing brace expansion,
such as <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0418">CVE-2011-0418</a> (<a href="http://cxsecurity.com/issue/WLB-2011050004">details</a>).</p>

<p class=pp>Unfortunately, none of these protections address the cost of matching a single path element of a single file name.
In 2005, <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0256">CVE-2005-0256</a> was issued for a <a href="http://marc.info/?l=bugtraq&amp;m=110935886414939&amp;w=2">DoS vulnerability in WU-FTPD 2.6.2</a>, because it ran for a very long time finding even a single match during:</p>

<pre><code>ftp&gt; dir ************************************************
         ************************************************
         ************************************************
         **.*
</code></pre>

<p class=lp>The apparent <a href="http://marc.info/?l=bugtraq&amp;m=110960890901497&amp;w=2">“fix” used in some implementations</a> is
to collapse multiple adjacent stars into a single star.
That solves one test case, but not the general problem.
In particular it doesn&rsquo;t help <code>a*a*a*a*a*a*a*a*b</code>.</p>

<p class=pp>The next section discusses ways to implement glob patterns efficiently,
but if you have an anonymous FTP server accepting glob patterns,
there are two more fundamental questions to ask:
Do you really need to run an anonymous FTP server anymore?
Does it really need to accept glob patterns?</p>

<p class=pp>At the very least, most FTP servers should probably reject
glob patterns with more than, say, 3 stars.
Note that glob patterns are only provided as a convenience for
command-line FTP users.
Graphical FTP clients typically use the
<a href="https://tools.ietf.org/html/rfc3659#page-23"><code>MLST</code> and <code>MLSD</code> commands</a>,
which have a machine-readable output format and are defined not to
interpret their arguments as glob patterns.</p>

<h2>Implementation Details</h2>

<p class=lp>How do these implementations work? What&rsquo;s going on here?</p>

<p class=pp>The obvious implementation of glob pattern matching against a single path element
is to walk the pattern and the name together, matching letters or wildcards in the pattern
to letters in the name.
If the walk reaches the end of the pattern at the same time as the end of the name, they match.</p>

<p class=pp>Here&rsquo;s a basic outline of that algorithm, in Go:</p>

<pre>
func match(pattern, name string) bool {
    px := 0
    nx := 0
    for px &lt; len(pattern) || nx &lt; len(name) {
        if px &lt; len(pattern) {
            c := pattern[px]
            switch c {
            default: // ordinary character
                if nx &lt; len(name) && name[nx] == c {
                    px++
                    nx++
                    continue
                }
            case '?': // single-character wildcard
                if nx &lt; len(name) {
                    px++
                    nx++
                    continue
                }
            case '*': // zero-or-more-character wildcard
                ...
            }
        }
        // Mismatch.
        return false
    }
    // Matched all of pattern to all of name. Success.
    return true
}
</pre>

<p class=lp>In this code, <code>px</code> is the index into the pattern
and <code>nx</code> the index into the name.
The loop runs until both pattern and name are exhausted,
meaning <code>px</code> <code>==</code> <code>len(pattern)</code> and <code>nx</code> <code>==</code> <code>len(name)</code>.
If it does happen that both pattern and name are exhausted at the same time,
then we have a match (the final <code>return</code> <code>true</code>).
Inside the loop, the code must make progress (advance <code>px</code> or <code>nx</code> or both) and <code>continue</code> on each iteration.
If not, the control flow ends up at the bottom of the loop body
(marked <code>//</code> <code>Mismatch.</code>) and reports no match.</p>

<p class=pp>The only difficulty is in the implementation of the variable-length wildcard pattern (<code>case</code> <code>'*'</code>):
how much of the name should that match?
In general, the code must try all possibilities from matching nothing to matching the entire remainder of the string.
The obvious way to do that is with recursion:</p>

<pre>
<span style="color: #aaa;">func match(pattern, name string) bool {
    px := 0
    nx := 0
    for px &lt; len(pattern) || nx &lt; len(name) {
        if px &lt; len(pattern) {
            c := pattern[px]
            switch c {
            default: // ordinary character
                if nx &lt; len(name) && name[nx] == c {
                    px++
                    nx++
                    continue
                }
            case '?': // single-character wildcard
                if nx &lt; len(name) {
                    px++
                    nx++
                    continue
                }
            case '*': // zero-or-more-character wildcard<span style="color: #000; font-weight:bold;">
                // Try to match at nx, nx+1, and so on.
                for ; nx &lt;= len(name); nx++ {
                    if match(pattern[px+1:], name[nx:]) {
                        return true
                    }
                }</span>
            }
        }
        // Mismatch.
        return false
    }
    // Matched all of pattern to all of name. Success.
    return true
}
</span></pre>

<p class=lp>If there are <i>e</i> stars that can each potentially end their matches at <i>n</i> positions in the string,
that gives <i>n</i><sup><i>e</i></sup> possibilities to explore, leading to the exponential run times observed earlier.
However, most of these possibilities are not worth exploring.
Because <code>*</code> is the only variable-sized
wildcard in the pattern syntax and therefore the only
source of possible backtracking, there&rsquo;s an even easier implementation:
don&rsquo;t backtrack to an earlier star.</p>

<p class=pp>Consider the pattern <code>a*bx*cy*d</code>.
If we end the first star at the first <code>bx</code>, we have the rest of the name to find the <code>cy</code> and then the <code>d</code>.
Using any later <code>bx</code> can only remove choices for <code>cy</code> and <code>d</code>; it cannot lead to a successful match
that using the first <code>bx</code> missed.
So we should implement
<code>a*bx*cy*d</code> without any second-guessing,
as
“find a leading <code>a</code>, then find the earliest <code>bx</code> after that, then find the earliest <code>cy</code> after that, then find a trailing <code>d</code>, or else give up.”</p>

<p class=pp>We can implement this algorithm by replacing the handling of the star wildcard
in our Go program:</p>

<pre>
<span style="color: #aaa;">func match(pattern, name string) bool {
    px := 0
    nx := 0
    <span style="color: black; font-weight: bold;">nextPx := 0
    nextNx := 0</span>
    for px &lt; len(pattern) || nx &lt; len(name) {
        if px &lt; len(pattern) {
            c := pattern[px]
            switch c {
            default: // ordinary character
                if nx &lt; len(name) && name[nx] == c {
                    px++
                    nx++
                    continue
                }
            case '?': // single-character wildcard
                if nx &lt; len(name) {
                    px++
                    nx++
                    continue
                }
            case '*': // zero-or-more-character wildcard
                <span style="color: black; font-weight: bold;">// Try to match at nx.
                // If that doesn't work out,
                // restart at nx+1 next.
                nextPx = px
                nextNx = nx + 1
                px++
                continue</span>
            }
        }
        <span style="color: black; font-weight: bold;">// Mismatch. Maybe restart.
        if 0 &lt; nextNx && nextNx &lt;= len(name) {
            px = nextPx
            nx = nextNx
            continue
        }</span>
        return false
    }
    // Matched all of pattern to all of name. Success.
    return true
}</span>
</pre>

<p class=lp>Each time the code encounters a star, it implements the repeated trials needed
for that star by recording in <code>nextPx</code>, <code>nextNx</code> where to restart the search
if the current match fails.
Each subsequent star encountered overwrites the restart information
for the previous star, in effect locking in the choice made for the
previous star.
If you&rsquo;d like to experiment, I&rsquo;ve posted <a href="glob.go">both of these programs and a test harness</a>.</p>

<p class=pp>An alternate implementation of the algorithm would be to split the
pattern on stars and then consider each of the star-separated
subpatterns in turn, special-casing the first subpattern and the last,
which must be anchored at the start and end of the name, respectively.
Go&rsquo;s <a href="https://golang.org/src/path/filepath/match.go">src/path/filepath/match.go</a>
is an example of this implementation.</p>

<p class=pp>Go&rsquo;s <a href="https://golang.org/pkg/path/filepath/#Match"><code>filepath.Match</code></a>
(used by <a href="https://golang.org/pkg/path/filepath/#Glob"><code>filepath.Glob</code></a>),
glibc&rsquo;s <code>glob</code>, and vsftpd&rsquo;s pattern matcher
all use this algorithm.</p>

<p class=pp>A more straightforward approach is to translate the glob pattern to
a regular expression and then invoke a linear-time regular expression match.
Plan 9&rsquo;s ftpd does this, as does the <code>ls</code> <code>|</code> <code>grep</code> example above.
(<a href="https://github.com/python/cpython/blob/master/Lib/fnmatch.py#L39">Python also does this</a>, but then it runs the regular expression
with an exponential-time matching engine.)</p>

<p class=pp>I have not looked at the other linear-time implementations to see what they do,
but I expect they all use one of these two approaches.</p>

<h2>Additional Reading</h2>

<p class=lp>This post is an elaboration of an informal <a href="https://plus.google.com/u/2/+RussCox-rsc/posts/8aANoDNvhie">2012 Google+ post</a>
showing that most shells used exponential-time glob expansion.
At the time, Tom Duff, the author of Plan 9&rsquo;s rc shell, commented that,
“I can confirm that rc gets it wrong.
My excuse, feeble as it is, is that doing it that way meant that the code took 10 minutes to write,
but it took 20 years for someone to notice the problem.
(That&rsquo;s 10 ‘programmer minutes’, i.e. less than a day.)”
I agree that&rsquo;s a reasonable decision for a shell.
In contrast, a language library routine, not to mention a network server,
today needs to be robust against worst-case inputs that might be controlled
by remote attackers,
but nearly all of the code in question predates that kind of concern.
I didn&rsquo;t realize the connection to FTP servers until I started doing
additional research for this post and came across a reference to
CVE-2010-2632 in <a href="https://github.com/freebsd/freebsd/blob/5b0d2af29a95/lib/libc/gen/glob.c#L100">FreeBSD&rsquo;s <code>glob</code> implementation</a>.</p>

<p class=pp>Dave Presotto, the author of Plan 9&rsquo;s ftpd, avoided rc&rsquo;s glob implementation not
because of the algorithmic complexity but to make sure that long strings
were handled safely (using a Plan 9 library for handling long strings in C).
He wrote this comment at the top of
Plan 9&rsquo;s <a href="http://plan9.bell-labs.com/sources/plan9/sys/src/cmd/ip/glob.c">/sys/src/cmd/ip/glob.c</a>,
which converts glob expressions into regular expressions:</p>

<pre><code>/*
 *  I wrote this glob so that there would be no limit
 *  on element or path size.  The one in rc is probably
 *  better, certainly faster. - presotto
 */
</code></pre>

<p class=lp>As it turns out, this is untrue: the one in rc is certainly slower, at least in terms of
worst-case asymptotics.</p>

<p class=pp>If you liked this post, you may also like to browse
Nelson Elhage&rsquo;s <a href="https://accidentallyquadratic.tumblr.com/post/113840433022/why-accidentally-quadratic">Accidentally Quadratic</a> collection.
(Of course, here the glob pattern matching is accidentally exponential.)</p>

<h2><a name="updates">Updates, as of April 28, 2017.</h2>

<p class=lp>NetBSD has an <a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/gen/glob.c.diff?r1=1.36&amp;r2=1.37&amp;f=h">updated glob</a>
pending for the next release.</p>

<p class=pp>Perl has an <a href="https://perl5.git.perl.org/perl.git/commitdiff/33252c318625f3c6c89b816ee88481940e3e6f95?hp=57ab6c610267dba697199c8256f4258af7d391c1">updated glob</a> pending for the next release.</p>

<p class=pp>Pure-FTPd 1.0.46 has added a <a href="https://github.com/jedisct1/pure-ftpd/commit/63d98420e2c205c40e5a0849bde142e0aab17955">check that patterns must not have more than three stars</a>.</p>

<p class=pp>Thanks to <a href="https://news.ycombinator.com/item?id=14185822">js2 on Hacker News</a> for pointing out that Python translates globs to
regular expressions.</p>

      </div>
      
      
      <div id="disqus_thread"></div>
      <script>
      var disqus_config = function () {
          this.page.url = "https://research.swtch.com/glob";  
          this.page.identifier = "blog/glob"; 
      };
      (function() { 
          var d = document, s = d.createElement('script');
          s.src = '//swtch.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
      
    </div>

    
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3319603-2");
pageTracker._initData();
pageTracker._trackPageview();
</script>

    
    
  </body>
</html>
















