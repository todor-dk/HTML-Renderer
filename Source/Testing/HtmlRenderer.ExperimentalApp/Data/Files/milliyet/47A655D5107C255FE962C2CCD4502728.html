<html>
<head>
    <title>Milliyet.com.tr Google Chrome Habercisi</title>
    <script src="jq.js"></script>
    <script type="text/javascript">
        if (/iPhone | iPad | iPod |AppleWebKit /i.test(navigator.userAgent)) {
            window.location = "/indexIphone.html";
        }
        if (/Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            window.location = "/indexMobil.html";
        }
        function tumuHover() { $(".tumuBox").show(); $(".header .tumu1").addClass("hovering"); if (ua.indexOf("msie") != -1) $("#MH").attr("style", "display:none"); } function tumuHoverOut() { $(".tumuBox").hide(); $(".header .tumu1").removeClass("hovering"); }
    </script>
    <link href="/d/c/push.css" rel="stylesheet" type="text/css" />
    <script>        var _comscore = _comscore || []; _comscore.push({ c1: "2", c2: "7848742" }); (function () { var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true; s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js"; el.parentNode.insertBefore(s, el); })();</script>
    <noscript><img src="http://b.scorecardresearch.com/p?c1=2&c2=7848742&cv=2.0&cj=1" /></noscript>
    <script type="text/javascript">
        //--><![CDATA[//><!--
        var pp_gemius_identifier = '.Ag6tfymEya_dXDAyJ2BJ3a5.hhN8W_I6dMR_EkWu8P.s7';
        // lines below shouldn't be edited
        function gemius_pending(i) { window[i] = window[i] || function () { var x = window[i + '_pdata'] = window[i + '_pdata'] || []; x[x.length] = arguments; }; };
        gemius_pending('gemius_hit'); gemius_pending('gemius_event'); gemius_pending('pp_gemius_hit'); gemius_pending('pp_gemius_event');
        (function (d, t) {
            try {
                var gt = d.createElement(t), s = d.getElementsByTagName(t)[0], l = 'http' + ((location.protocol == 'https:') ? 's' : ''); gt.setAttribute('async', 'async');
                gt.setAttribute('defer', 'defer'); gt.src = l + '://gatr.hit.gemius.pl/xgemius.js'; s.parentNode.insertBefore(gt, s);
            } catch (e) { }
        })(document, 'script');
                                                                                                                                    
    </script>

 <link rel="manifest" href="/d/j/manifest.json?v=1">

</head>
<body>
 <script src="https://www.gstatic.com/firebasejs/3.7.1/firebase.js"></script>
   <script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyDkvMd5m2zTAt1WSfNjX37lceiegFk3y4k",
    authDomain: "haberci-971.firebaseapp.com",
    databaseURL: "https://haberci-971.firebaseio.com",
    storageBucket: "haberci-971.appspot.com",
    messagingSenderId: "837616105301"
  };
  firebase.initializeApp(config);
</script>
    <div id="_Middle" class="">
        <div class="header">
           
            <div class="logoBar" style="position: relative; z-index: 20; margin-top:10px;">
                <a class="logo" title="Haberler" href="http://www.milliyet.com.tr">
                    <img alt="Haberler" src="/D/i/_SubV2/milliyet-logo.png">
                </a><div class="search searchMain">
                </div>

                <script>                    window.onload = function () { var _agent = navigator.userAgent.toLowerCase(); if (_agent.indexOf("ipad") > -1) { document.getElementById('ipadweb').style.display = 'none'; document.getElementById('ipadozel').style.display = 'block'; } }      </script>
                <div id="ipadozel" style="display: none;">
                    <a href="http://m.milliyet.com.tr/ipad/" style="width: 132px; height: 70px; float: left;
                        margin: 14px 0 0 0; position: relative">
                        <img src="/d/i/_SubV2/ipadozel.jpg" width="132" height="70">
                    </a>
                </div>
                <div id="ipadweb">
                    <div id="divBanner100x100" style="position: relative; width: 140px; z-index: 5;float:right;">
                        <!--Milliyet_Anasayfa/milliyet_anasayfa_yerel_132x70-->
                        <div id="Gad-808" style="width: 132px; height: 70px;">

                        </div>
                    </div>
                </div>
                <div class="cls">
                </div>
            </div>
            <div class="cls2">
            </div>
        </div>
        <div class="middle pTop0">
            <div class="pshtop">
                <strong>Google Chrome bildirimlerinizi aktif edin!</strong> <span>Haberler sana gelsin...</span>
            </div>
            <div class="pushcon">
                <a href="javascript:;" id="pbutton" class="pbutton"></a>
            </div>
            <div class="cls">
            </div>
        </div>
        <div class="footerNew2">
            <div class="bottom">
                <a title="Milliyet.com.tr" href="http://www.milliyet.com.tr" class="footerLogo">
                </a><span>©Copyright 2015 </span><span style="float: left;">
                    Sitemizde yayınlanan haberlerin
                    telif hakları <a href="http://www.milliyet.com.tr" title="gazete">gazete</a> ve
                    haber kaynaklarına aittir, haberleri kopyalamayınız.
                </span>
            </div>
        </div>
    </div>
    <script>
var pushButton = document.querySelector('.pbutton');

                    
  const messaging = firebase.messaging();

        messaging.getToken().then(function(currentToken){
            if (currentToken) {
                 getPushStatus(currentToken);
                 console.log(currentToken);
            }
            else{
                console.log("There is no token");
				pushButton.textContent = 'Şimdi Bildirimleri Aktif Et!';
                 $('#pbutton').attr('onclick', 'subscribePush()');
            }
        });
        
        



        messaging.onMessage(function(payload){
            console.log('message: ',payload);
        });


function getPushStatus(token) {
     $.ajax({
               type: 'POST',
               url: '/GetPushStatus.ashx?subscriptionId='+token,
               timeout: 2000,
               success: function(data) {
              if (data==1) {
                pushButton.textContent = 'Bildirimleri Kapat';
                $('#pbutton').attr('onclick', 'unsubscribePush()');
               } 
               else{
                 pushButton.textContent = 'Şimdi Bildirimleri Aktif Et!';
                 $('#pbutton').attr('onclick', 'subscribePush()');
               }
                                                
          },
               error: function (XMLHttpRequest, textStatus, errorThrown) {
               console.log("error retrieving content");
    } 
    });
                     
                  }                  

                    function subscribePush() {
                            messaging.requestPermission().then(
                                function(){ 
                                    return messaging.getToken();
                                     }).then(
                                     function(token){
                                        sendSub(token);
                                        pushButton.textContent = 'Bildirimleri Kapat';
                                        $('#pbutton').attr('onclick', 'unsubscribePush()');
                                            }).catch(
                                            function(err){
                                                       console.log('Hata');
                                                               });
                    }

                    function unsubscribePush() {
                        messaging.getToken().then(
                            function(currentToken){
                                cancelSub(currentToken);
                                pushButton.textContent = 'Şimdi Bildirimleri Aktif Et!';
                                $('#pbutton').attr('onclick', 'subscribePush()');
                                 
                            });
                    }




                    function sendSub(subscriptionId) {
                        var endPoint="https://haberci.milliyet.com.tr/";
                        var xhttp = new XMLHttpRequest();
                        xhttp.onreadystatechange = function () {
                            if (xhttp.readyState == 4 && xhttp.status == 200) {
                                //console.log(xhttp.responseText);
                            }
                        };
                        xhttp.open("POST", "/Handler.ashx?endpoint=" + endPoint + "&subscriptionId=" + subscriptionId + "&IsActive=1", true);
                        xhttp.send();
                    }

                  
                    

                    function cancelSub(subscriptionId) {
                        var endPoint="https://haberci.milliyet.com.tr/";
                        var xhttp = new XMLHttpRequest();
                        xhttp.onreadystatechange = function () {
                            if (xhttp.readyState == 4 && xhttp.status == 200) {
                                //console.log(xhttp.responseText);
                            }
                        };
                        xhttp.open("POST", "/Handler.ashx?endpoint=" + endPoint + "&subscriptionId=" + subscriptionId + "&IsActive=0", true);
                        xhttp.send();
                    }


                    var gacodes = [];

                    (function (i, s, o, g, r, a, m) {
                    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                        (i[r].q = i[r].q || []).push(arguments)
                    }, i[r].l = 1 * new Date(); a = s.createElement(o),
                        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
                    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

                    ga('create', 'UA-3159771-13', 'auto', { 'name': 'maincode' });
                    if (gacodes.length > 0) { for (i = 0; i < gacodes.length; i++) { ga('create', gacodes[i][1], 'auto', { 'name': gacodes[i][0] }); } }
                    ga('maincode.send', 'pageview');
                    if (gacodes.length > 0) { for (i = 0; i < gacodes.length; i++) { ga(gacodes[i][0] + '.send', 'pageview'); } }



    </script>

</body>
</html>
