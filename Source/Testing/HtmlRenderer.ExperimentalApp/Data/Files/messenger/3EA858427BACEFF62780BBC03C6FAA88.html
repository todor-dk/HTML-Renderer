<!DOCTYPE html>


<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head><link rel="canonical" href="https://msdn.microsoft.com/en-us/library/cc298452.aspx" />
    <title>How to: Sign In to Windows Live Messenger</title>







<meta name="DCS.dcsuri" content="/en-us/library/cc298452(d=default,l=en-us,v=msdn.10).aspx" />

<meta name="NormalizedUrl" content="https://msdn.microsoft.com/en-us/library/cc298452(d=default,l=en-us,v=msdn.10).aspx" />

<meta name="ms.normalizedurl" content="https://msdn.microsoft.com/en-us/library/cc298452(d=default,l=en-us,v=msdn.10).aspx" />

<meta name="AmbientContext" content="{&quot;layout.limit_max_width&quot;:false,&quot;AmbientContextId&quot;:&quot;7AD6A3AE-3AFD-4B30-9344-A6F599E7FAE3&quot;,&quot;display.use_large_font&quot;:false,&quot;insight.perf_timing&quot;:true,&quot;AmbientContextDownstream&quot;:{&quot;LogTrace&quot;:false},&quot;display.high_contrast&quot;:false,&quot;insight.use_wedcs_vnext&quot;:true}" />

<meta name="VotingContextUrl" content="https://msdn.microsoft.com/en-us/library/cc298452(d=default,l=en-us,v=msdn.10).aspx" />

<meta name="MN" content="61C41DD0-9:45:44 AM" />

<meta name="Search.ShortId" content="cc298452" />

<meta name="ms.shortidmsdn" content="cc298452" />

<meta name="ms.locale" content="en-us" />

<meta name="ms.prodver" content="MSDN.10" />

<meta name="ms.contentlang" content="EN" />

<meta name="ms.lang" content="EN" />

<meta name="ms.loc" content="US" />

<meta name="ms.sitever" content="2017.07.03.3" />

<meta name="ms.assetid" content="3868b288-b57b-4a00-bf8d-2183ff363d21" />

<meta name="ms.auth" content="0" />

<meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    
        









    <script type="text/javascript" data-do-not-move="true">
        //<![CDATA[
        var AmbientContext = null;

        (function(){
            var root = (function(){return this;}).call(null);

            var GetCookie = function(name){
                var cookies = root.document.cookie ? root.document.cookie.split('; ') : [];
                for (var i = 0; i < cookies.length; i++) {
                    var pos = cookies[i].indexOf('=');
                    if (name === root.decodeURIComponent(cookies[i].slice(0, pos)))
                    {
                        var cookie = cookies[i].slice(pos + 1).replace(/\+/g, ' ');
                        cookie = root.decodeURIComponent(cookie);
                        return cookie;
                    }
                }
            };

            var JsonDeserialize = function(content) {
                return root.JSON && root.JSON.parse ? root.JSON.parse(content) : (new Function('return (' + content + ')'))();
            };

            try {
                AmbientContext = GetCookie('AmbientContext');
                AmbientContext = AmbientContext && JsonDeserialize(AmbientContext);
            } catch(ex) {
            } finally {
                AmbientContext = AmbientContext || null;
            }
        })();
        //]]>
    </script>

    <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js" data-do-not-move="true" data-provides="jQuery"></script>
    
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:ImageSprite,0:TopicResponsive,0:TopicResponsive.MediaQueries,1:CodeSnippet,1:ProgrammingSelector,1:ExpandableCollapsibleArea,0:CommunityContent,1:TopicNotInScope,1:FeedViewerBasic,1:ImageSprite,2:Header,2:HeaderFooterSprite,2:Header.MediaQueries,3:Banner.MediaQueries,0:Breadcrumbs,0:Breadcrumbs.MediaQueries,0:ResponsiveToc,0:ResponsiveToc.MediaQueries,0:LibraryMemberFilter,2:Footer,2:Footer.MediaQueries,4:StandardRating,5:LinkList,0:BaseResponsive,6:MsdnResponsive,0:Tables.MediaQueries;/Areas/Library/Content:0,/Areas/Epx/Content/Css:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Epx/Shared/Content:3,/Areas/Global/Content:4,/Areas/Epx/Themes/Base/Content:5,/Areas/Library/Themes/Msdn/Content:6&amp;amp;v=8B3CC74669A5A4CA714BECFAB690882B" /></head>
<body class="library Chrome">
    <div id="page">

        

        
    

    
    <link type="text/css" rel="stylesheet" />
    
        
        
    <input type="hidden" id="isHeaderBleeding" value="true" />
    <div id="ux-header" dir="ltr" class="ltr msdn" ms.pgarea="header">
        

      <header>
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow" role="banner">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/en-us" title="MSDN home" ms.cmpgrp="mslogo">
                  <div class="clip70x15">
                    <img alt="Microsoft Logo" id="msft-logo" class="msft-logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636347038738428747" />
                  </div>
                </a>
                <div class="GrayPipeDiv clip1x18">
                  <img alt="Gray Pipe" class="GrayPipe" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636347038738428747" />
                </div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/en-us">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/en-us">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/en-us">Developer</a>
              </div>
              <div class="right" ms.cmpgrp="aux nav">
                <div id="signIn" aria-label="Profile button">

  <div class="profileImage"></div>



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=13&amp;ct=1499877944&amp;rver=6.7.6640.0&amp;wp=mcmbi&amp;wlcxt=msdn%24msdn%24msdn&amp;wreply=https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fcc298452.aspx&amp;lc=1033&amp;id=254354&amp;mkt=en-us">Sign in</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentName="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://my.visualstudio.com/?wt.mc_id=o~msft~msdn~nav~subscriber&amp;campaign=o~msft~msdn~nav~subscriber" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
    <p xmlns="">Subscriber portal</p>
  </a>
</div>
                    <div data-fragmentName="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://www.visualstudio.com/free-developer-offers/" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">Get tools</a>
</div>
                  </div>
                        <div>
                            
                        </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left" role="navigation" aria-label="header toc" ms.cmpgrp="main nav">
                <a id="grip" class="menu-icon" href="javascript:void(0)" role="button" aria-label="navigation menu"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                                <a href="javascript:void(0)" role="button" aria-expanded="false">Downloads</a>
                                <ul class="navL2">
                                        <li class="inactive">

                                                <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" role="link" title="Visual Studio">Visual Studio</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" role="link" title="SDKs">SDKs</a>
                                        </li>
                                        <li class="inactive toggle">

                                                <a href="javascript:void(0)" title="Trial software" role="button" aria-expanded="false">Trial software</a>
                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="Free downloads" role="link">Free downloads</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office resources" role="link">Office resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 resources" role="link">SharePoint Server 2013 resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express resources" role="link">SQL Server 2014 Express resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 resources" role="link">Windows Server 2012 resources</a>
                                                        </li>
                                                </ul>
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                                <a href="javascript:void(0)" role="button" aria-expanded="false">Programs</a>
                                <ul class="navL2">
                                        <li class="inactive toggle">

                                                <a href="javascript:void(0)" title="Subscriptions" role="button" aria-expanded="false">Subscriptions</a>
                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="Overview" role="link">Overview</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators" role="link">Administrators</a>
                                                        </li>
                                                </ul>
                                        </li>
                                        <li class="inactive toggle">

                                                <a href="javascript:void(0)" title="Students" role="button" aria-expanded="false">Students</a>
                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine" role="link">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft Student Partners" role="link">Microsoft Student Partners</a>
                                                        </li>
                                                </ul>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://msdn.microsoft.com/applicationbuilder" role="link" title="ISV">ISV</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://www.microsoft.com/bizspark" role="link" title="Startups">Startups</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://events.microsoft.com/" role="link" title="Events">Events</a>
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                                <a href="javascript:void(0)" role="button" aria-expanded="false">Community</a>
                                <ul class="navL2">
                                        <li class="inactive">

                                                <a href="https://msdn.microsoft.com/magazine/dd767791" role="link" title="Magazine">Magazine</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://social.msdn.microsoft.com/forums/" role="link" title="Forums">Forums</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://blogs.msdn.microsoft.com/" role="link" title="Blogs">Blogs</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://channel9.msdn.com/" role="link" title="Channel 9">Channel 9</a>
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                                <a href="javascript:void(0)" role="button" aria-expanded="false">Documentation</a>
                                <ul class="navL2">
                                        <li class="inactive current">

                                                <a href="https://msdn.microsoft.com/library" role="link" title="APIs and reference">APIs and reference</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://msdn.microsoft.com/developer-centers-msdn" role="link" title="Dev centers">Dev centers</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://code.msdn.microsoft.com/" role="link" title="Samples">Samples</a>
                                        </li>
                                        <li class="inactive">

                                                <a href="https://msdn.microsoft.com/retiredcontent" role="link" title="Retired content">Retired content</a>
                                        </li>
                                </ul>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right" ms.title="search" role="search">
                <div data-fragmentName="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button" role="button" aria-label="search finder">
        <div id="search-finder-div" class="clip16x20">
          <img alt="search finder" id="search-finder" class="search-finder" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636347038738428747" />
        </div>
      </button>
      <button id="HeaderSearchButton" style="display:none"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIconDiv" class="clip16x20" tabindex="0">
        <img alt="search clear" id="searchCloseIcon" class="search-clear-x" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636347038738428747" />
      </div>
      <div id="searchTextContainer" style="width: 0;">
        <input id="HeaderSearchTextBox" name="query" type="text" aria-label="search edit textbox" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)" />
      </div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    </div>

    
    
    
    <div id="jumpInfo" style="display: none">We’re sorry. The content you requested has been removed. You’ll be auto redirected in 1 second.</div>





<link type="text/css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" />


    <div id="breadcrumbs" ms.pgarea="body" ms.cmpgrp="breadcrumbs">
        <div id="breadcrumbDesktop" class="breadCrumb">
                        <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/dd570035.aspx" title="Windows Live Messenger Web Toolkit"></a></span>
                        <span><a href="https://msdn.microsoft.com/en-us/library/cc298458.aspx" title="Windows Live Messenger Library"><span>Windows Live Messenger Library</span></a></span>
                        <span><a href="https://msdn.microsoft.com/en-us/library/cc298457.aspx" title="Developing with the Windows Live Messenger Library"><span>Developing with the Windows Live Messenger Library</span></a></span>
                        <span class="breadcrumbDropSmall">
                            <a id="breadcrumbDropDownButton" href="#" targethref="https://msdn.microsoft.com/en-us/library/cc298457.aspx" title="Windows Live Messenger Library Tasks"><span>Windows Live Messenger Library Tasks</span></a>
                        </span>
        </div>
        <div id="breadcrumbDropDownMenu"></div>

        <div id="breadcrumbTablet" class="breadCrumb">
                        <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/cc298457.aspx" title="Developing with the Windows Live Messenger Library"></a></span>
                    <span><a href="https://msdn.microsoft.com/en-us/library/cc298462.aspx" title="Windows Live Messenger Library Tasks"><span>Windows Live Messenger Library Tasks</span></a></span>
                <span class="breadcrumbDropSmall"><a id="tocDropDownButton" href="#" title="How to: Sign In to Windows Live Messenger"><span>How to: Sign In to Windows Live Messenger</span></a></span>
        </div>
        <div id="tocDropDownMenu"></div>
        <div id="breadcrumbMobile" class="breadCrumb">
                <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/cc298462.aspx" title="Windows Live Messenger Library Tasks"></a></span>
            <span class="breadcrumbDropSmall"><a id="tocPopupButton" href="#" title="How to: Sign In to Windows Live Messenger"><span>How to: Sign In to Windows Live Messenger</span></a></span>
        </div>
    </div>
    <div id="tocPopupMenu">
        <div id="tocPopMenuClose" class="tocCloseLarge"></div>
        <div id="tocTitle">How to: Sign In to Windows Live Messenger</div>        
    </div>

    


        <div id="body" ms.pgarea="body" class="">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="leftNav" ms.cmpgrp="left toc" role="navigation" aria-label="left toc">

    


<div id="tocnav" class="ArchiveV2">
    <div class="tocunselected">
        <div id="tocExpandArea">
            <span class="toc_empty"></span>
            <span id="tocExpandButton"><a href="javascript:void(0)" aria-label="expand sibling toc" role="button"></a></span>
        </div>
        <div id="tocExpand"></div>
    </div>
    <div class="tocselected"></div>
    <div class="tocunselected">
                <div class="toclevel current" data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc298452.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Sign In to Windows Live Messenger">How to: Sign In to Windows Live Messenger</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc298456.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Monitor Presence">How to: Monitor Presence</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc298459.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Change the User's Status">How to: Change the User's Status</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc298449.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Add or Remove a Contact">How to: Add or Remove a Contact</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc298451.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Manage Conversations">How to: Manage Conversations</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc742834.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Implement Presence Extensions">How to: Implement Presence Extensions</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc742835.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Implement Messaging Extensions">How to: Implement Messaging Extensions</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a href="https://msdn.microsoft.com/en-us/library/cc742836.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Access Windows Live Messenger Resources">How to: Access Windows Live Messenger Resources</a>                </div>
    </div>
    <a id="tocMenuToggler" href="javascript:void(0)" role="button">
        <span id="tocMenuTogglerIcon" class="tocMenuCollapse" role="button" aria-expanded="true" aria-label="Table of contents menu"></span>
        <div id="tocMenuTogglerLabel">TOC</div>
    </a>
</div>            <div style="display:none">
                <div id="CollapseLocalizeString">Collapse the table of content</div>
                <div id="ExpandLocalizeString">Expand the table of content</div>
            </div>
        <div>
            <a id="isd_archiveControlResponsive" style="display:none;" href="javascript:void(0)" role="button" aria-label="Hide Archived Versions" data-include-archive="Show Archived Versions" data-exclude-archive="Hide Archived Versions">
            </a>
            <div id="isd_archiveInstrument" style="display:none">This documentation is archived and is not being maintained.</div>
        </div>
    </div>
     <div id="content" class="content" ms.cmpgrp="content body" role="main">








    <div id="archiveDisclaimerText" style="display:none">This documentation is archived and is not being maintained.</div>




<div class="topic" xmlns="http://www.w3.org/1999/xhtml">
  <h1 class="title">How to: Sign In to Windows Live Messenger</h1>
  
  <div id="mainSection">
      <div id="mainBody">
        
         <p></p> 
        <span id="changeHistory">
        </span>
    <p>The <strong>DelegatedAuthControl</strong><strong> </strong>object is designed to help abstract the functionality that is required to request consent from a user. You can embed the <strong>DelegatedAuthControl</strong> object on a Web page so that a user can initiate the consent and sign-in process for Windows Live Messenger. </p>
    <p>After the user grants consent, the application can sign the user in. When the sign-in process is complete, the application can access the user's contacts, create a conversation, and perform other tasks through the <strong>User</strong> object. This topic describes the code that is used to host the <strong>DelegatedAuthControl</strong> object. The following programming tasks create the user sign-in process.</p>
    <ol><li>
        Define an event handler for <strong>DelegatedAuthControl.ConsentCompleted</strong> event. This event is raised when the user provides consent for the application to use Delegated Authentication. This event handler performs the following tasks.<br />
        <ul><li>
            Hide the <code>div</code> element that contains the <strong>DelegatedAuthControl</strong> object.<br />
          </li><li>
            Pass the consent token to the application server so that it can decrypt the consent token and return the user delegation token.<br />
          </li></ul>
      </li><li>
        Define an event handler for the <strong>DelegatedAuthIdentity.AuthenticationCompleted</strong> event. This event is raised when the user is authenticated by using the delegation token. The event handler performs the following tasks.<br />
        <ul><li>
            Instantiate the <strong>User</strong> object with <strong>DelegatedAuthIdentity</strong>. <br />
          </li><li>
            Subscribe to the <strong>User.SignInCompleted</strong> event. <br />
          </li><li>
            Call the <strong>User.SignIn</strong> method.<br />
          </li></ul>
      </li><li>
        Define an event handler for the <strong>User.SignInCompleted</strong> event. This event is raised when the user signs in to Messenger successfully. You can use this event handler to perform additional tasks, such as displaying the user's contact list.<br />
      </li><li>
        Create a server-side function that retrieves the delegation token by decrypting the consent token. After receiving the delegation token from the server, the application should create <strong>DelegatedAuthIdentity</strong> and subscribe to the <strong>DelegatedAuthIdentity.AuthenticationCompleted</strong> event.<br />
      </li><li>
        After the host page loads, the application perform the following tasks.<br />
        <ul><li>
            Instantiate <strong>Microsoft.Live.Messenger.UI.DelegatedAuthControl</strong>.<br />
          </li><li>
            Subscribe to the<strong> </strong><strong>DelegatedAuthControl.ConsentCompleted</strong><strong> event</strong>. <br />
          </li></ul>
      </li></ol>
    <p>After a user grants consent to an application, the <strong>DelegatedAuthControl</strong> object is no longer used to sign in the user. Instead, the following steps are required.</p>
    <ol><li>
        Create <strong>DelegatedAuthIdentity</strong> with the user's delegation token.<br />
      </li><li>
        Instantiate the <strong>User</strong> object with <strong>DelegatedAuthIdentity</strong>.<br />
      </li><li>
        Subscribe to the <strong>User.SignInCompleted</strong> event. This event is raised when a user signs in to Messenger.<br />
      </li><li>
        Call the <strong>User.SignIn</strong> method.<br />
      </li></ol>
    <div class="alert"><table summary="table"><tr><th scope="col"><img id="note" alt="Cc298452.note(en-us,MSDN.10).gif" src="https://i-msdn.sec.s-msft.com/areas/global/content/clear.gif" title="Cc298452.note(en-us,MSDN.10).gif" xmlns="" class="cl_IC101471" />Note: </th></tr><tr><td>
      The Privacy.htm and Channel.htm pages are required on your Web site domain to host <strong>DelegatedAuthControl</strong>. For more information, see <a href="https://msdn.microsoft.com/en-us/library/cc298453.aspx">Windows Live Messenger Library Development Basics</a>.
    </td></tr></table></div>
  <div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a class="LW_CollapsibleArea_TitleAhref" title="Collapse" role="heading"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">To add references to the host Web page</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div"><a href="/en-us/library/cc298452.aspx#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="Right-click to copy and share the link for this section"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr" /></div></div></h2><div class="sectionblock"><a id="procedureToggleEJBHA"></a><ol><li>
        
          <p>In the <code>&lt;head&gt;</code> element of the page, add a <code>&lt;script&gt;</code> element to load the Windows Live Messenger Library.</p>
          
<div id="code-snippet-1" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_70fc8581-e980-4e16-b240-be72200b7a53');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_70fc8581-e980-4e16-b240-be72200b7a53" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
&lt;script src="http://www.wlmessenger.net/api/3.7/Loader.js" type="text/javascript" language="javascript"&gt;&lt;/script&gt;
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>In the body of the Web page, add a <code>&lt;script&gt;</code> element to reference your application's main JavaScript file.</p>
          
<div id="code-snippet-2" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_cf96a790-60a6-4ddd-9388-c5797a165e13');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_cf96a790-60a6-4ddd-9388-c5797a165e13" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
&lt;script src="SignIn.js" type="text/javascript" language="javascript"&gt;&lt;/script&gt;
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Add a DOM element to contain <strong>DelegatedAuthControl</strong>. </p>
          <p>In this example, it is a <code>&lt;div&gt;</code> with the ID "signinframe".</p>
          
<div id="code-snippet-3" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_3ee05bda-b86d-48cf-8d6d-8aa0aa87fbbe');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_3ee05bda-b86d-48cf-8d6d-8aa0aa87fbbe" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
&lt;div id="signinframe"&gt; 
        Sign In 
&lt;/div&gt; 
</pre></div>
            
        </div>
    </div>
</div>

        
      </li></ol></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a class="LW_CollapsibleArea_TitleAhref" title="Collapse" role="heading"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">To add code to your main JavaScript file</span></a><div id="Anchor_1" class="LW_CollapsibleArea_Anchor_Div"><a href="/en-us/library/cc298452.aspx#Anchor_1" class="LW_CollapsibleArea_Anchor_Img" title="Right-click to copy and share the link for this section"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr" /></div></div></h2><div class="sectionblock"><a id="procedureToggleEHBHA"></a><ol><li>
        
          <p>Create a new file named SignIn.js and initialize the following variables.</p>
          
<div id="code-snippet-4" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_9c49b6c7-0c2a-484f-846f-1886efa5d16f');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_9c49b6c7-0c2a-484f-846f-1886efa5d16f" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
_user = null;
_identity = null;
_delAuthControl = null;
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Create the <strong>onScriptsLoaded</strong> function to instantiate an instance of <strong>DelegatedAuthControl</strong> and subscribe to the <strong>consentCompleted</strong> event.  </p>
          <p>The application verifier token must be generated and inserted with server-side code. In the following example, the token is inserted as a string into the variable <em>appVerifierToken</em>. An application verifier token consists of your application ID and a time stamp, signed with your secret key. For details, see <a href="https://msdn.microsoft.com/en-us/library/dd570051.aspx">Using Application Verifier Tokens for Delegated Authentication</a>.</p>
          
<div id="code-snippet-5" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_9feb9609-fbe3-4cca-b8b7-6ae4b188d68e');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_9feb9609-fbe3-4cca-b8b7-6ae4b188d68e" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
function onScriptsLoaded()
{
    var hostUrl = window.location.href;
    var index = hostUrl.lastIndexOf("/");
    hostUrl = hostUrl.substring(0, index);

    var privUrl = hostUrl + "/Privacy.htm";
    var chanUrl = hostUrl + "/Channel.htm";
                
    // Use server side code to set your application verifier token here.
    var appVerifierToken = "appid%3d000000006800FBCC%26ts%3d1235706929%26s";

    _delAuthControl = new Microsoft.Live.Messenger.UI.DelegatedAuthControl("signinframe", privUrl, chanUrl, "en-US", appVerifierToken);
                
    // Replace "logo.jpg" with the URL to your application logo.
    _delAuthControl.set_applicationLogoUrl("logo.jpg");

    _delAuthControl.add_consentCompleted(consentCompleted);
} 
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Create the <strong>consentCompleted</strong> function to define a delegate that handles the <strong>consentCompleted</strong> event. </p>
          <p>At this point, the user has provided consent. However, the user is not authenticated or online. The application must use server-side code to decrypt the delegation token by using the consent token.</p>
          
<div id="code-snippet-6" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_b25aecff-4091-47af-9ab5-0a3af34d6173');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_b25aecff-4091-47af-9ab5-0a3af34d6173" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
function consentCompleted(sender, e) 
{
   var consentToken = e.get_consentToken();
            
   // An application passes the consent token to its servers. 
   // The consent token decrypts the token and extracts the user delegation token.
   getDelegationToken(consentToken, onGetDelegationToken);
}
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Add the code to pass the consent token back to the server to retrieve the delegation token. Implement the <strong>getDelegationToken</strong> function and call the <strong>onGetDelegationToken</strong> function when the delegation token is returned.</p>
          
<div id="code-snippet-7" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_a6dfb78d-460c-4d0c-a20b-8f7f336fc989');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_a6dfb78d-460c-4d0c-a20b-8f7f336fc989" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
function getDelegationToken(consentToken, callback) 
{
   // TODO: send the consent token to the application server to decrypt
   // and return the user delegation token.
}
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Create the <strong>onGetDelegationToken</strong> function to authenticate the user after the delegation token has been retrieved from the server. </p>
          
<div id="code-snippet-8" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_37702c63-8c2c-4e24-9b87-c6e33e183242');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_37702c63-8c2c-4e24-9b87-c6e33e183242" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
function onGetDelegationToken(delegationToken) 
{
   _identity = new DelegatedAuthIdentity(delegationToken);
   _identity.add_authenticationCompleted(onAuthCompleted);
}
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Create the <strong>onAuthCompleted</strong> function to sign the user in to Messenger when authentication is complete. This requires instantiating a <strong>User</strong> object and calling the <strong>signIn</strong> function.</p>
          
<div id="code-snippet-9" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_affe7846-6f01-4368-8b98-4d6aebb57af0');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_affe7846-6f01-4368-8b98-4d6aebb57af0" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
function onAuthCompleted(sender, e) 
{
   var identity = sender;
           
   if (!e.get_authenticationFailure()) 
   {
      user = new Microsoft.Live.Messenger.User(identity);
      _user.add_signInCompleted(onSignInCompleted);
      _user.signIn();
   }
}
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Create the <strong>onSignInCompleted</strong> function to perform tasks after the user has signed in. In this example, the current address for the user appears in a paragraph HTML element.</p>
          
<div id="code-snippet-10" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_fd88a29a-1591-41aa-87c8-b932909e53ed');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_fd88a29a-1591-41aa-87c8-b932909e53ed" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
function onSignInCompleted(sender, e) 
{
   if (e.get_resultCode() === Microsoft.Live.Messenger.SignInResultCode.success) 
   {
       // Display a confirmation message.
       var paragraph = document.createElement('p');
       var confirmMsg = document.createTextNode(_user.get_address().get_address() + ' is now signed in');
       paragraph.appendChild(confirmMsg);

       document.body.appendChild(paragraph);
   }
}
</pre></div>
            
        </div>
    </div>
</div>

        
      </li><li>
        
          <p>Add the following code to the end of your JavaScript file. This code loads the appropriate libraries that are required for <strong>DelegatedAuthControl</strong>.</p>
          
<div id="code-snippet-11" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_7aca359e-62a2-421f-90dd-08c6ed83d595');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_7aca359e-62a2-421f-90dd-08c6ed83d595" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
var loader = Microsoft.Live.Core.Loader;
loader.load(['messenger.core'], onScriptsLoaded);
</pre></div>
            
        </div>
    </div>
</div>

        
      </li></ol></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a class="LW_CollapsibleArea_TitleAhref" title="Collapse" role="heading"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">To authenticate with the delegation token</span></a><div id="Anchor_2" class="LW_CollapsibleArea_Anchor_Div"><a href="/en-us/library/cc298452.aspx#Anchor_2" class="LW_CollapsibleArea_Anchor_Img" title="Right-click to copy and share the link for this section"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr" /></div></div></h2><div class="sectionblock"><a id="procedureToggleEFBHA"></a><ol><li>
        
          <p>Use server-side code to retrieve the user delegation token that is stored in your application database.  </p>
        
      </li><li>
        
          <p>Insert the delegation token into the Web page.</p>
        
      </li><li>
        
          <p>Create the <strong>DelegatedAuthIdentity</strong> object with the delegation token.</p>
          
<div id="code-snippet-12" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_0169f399-a504-4aa6-930a-6688a058b4f3');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_0169f399-a504-4aa6-930a-6688a058b4f3" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
// Use server-side code to insert the user delegation token here.
var delegationToken = " EwCgARAnAAAU7KcbIzqHGnbpm1C2zYa2o9TnbAWAAM1RESuqZ7RK7uZdIzukGspQVPjdnMem";
var delAuthIdentity = new Microsoft.Live.Messeneger.DelegatedAuthIdentity(delegationToken);

_user = new Microsoft.Live.Messenger.User(delAuthIdentity);
</pre></div>
            
        </div>
    </div>
</div>

        
      </li></ol>
      
        <p>
          <strong>Note</strong>   If the user has provided consent, your application does not need to instantiate <strong>DelegatedAuthControl</strong> and wait for a <strong>consentCompleted</strong> event. If your site has stored the delegation token, you can authenticate the user immediately by creating the <strong>User</strong> object with the <strong>DelegatedAuthIdentity</strong> object.</p>
      
    </div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a class="LW_CollapsibleArea_TitleAhref" title="Collapse" role="heading"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Example</span></a><div id="Anchor_3" class="LW_CollapsibleArea_Anchor_Div"><a href="/en-us/library/cc298452.aspx#Anchor_3" class="LW_CollapsibleArea_Anchor_Img" title="Right-click to copy and share the link for this section"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr" /></div></div></h2><div class="sectionblock"><a id="codeExampleToggle"></a>
    
      
        <p>The following code example shows the JavaScript to instantiate <strong>DelegatedAuthControl</strong> and to create delegates to handle the <strong>ConsentCompleted</strong> and <strong>SignInCompleted</strong> events.</p>
      
    
    
<div id="code-snippet-13" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_5e33dbe6-4bd4-4895-a57b-3a37888d953f');" ms.cmptyp="CodeSnippet">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_5e33dbe6-4bd4-4895-a57b-3a37888d953f" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
_user = null;
_identity = null;
_delAuthControl= null;

function onScriptsLoaded()
{
    var hostUrl = window.location.href;
    var index = hostUrl.lastIndexOf("/");
    hostUrl = hostUrl.substring(0, index);

    var privUrl = hostUrl + "/Privacy.htm";
    var chanUrl = hostUrl + "/Channel.htm";
                
    // Use server-side code to set your application verifier token here.
    var appVerifierToken = "appid%3d000000006800FBCC%26ts%3d1235706929%26s";

    _delAuthControl = new Microsoft.Live.Messenger.UI.DelegatedAuthControl("signinframe", privUrl, chanUrl, "en-US", appVerifierToken);
                
    // Replace "logo.jpg" with the URL to your application logo.
    _delAuthControl.set_applicationLogoUrl("logo.jpg");

    _delAuthControl.add_consentCompleted(consentCompleted);
} 

function consentCompleted(sender, e) 
{
   var consentToken = e.get_consentToken();
            
   // An application must pass the consent token to its servers.
   // The consent token decrypts the token and extracts the user's delegation token.
   getDelegationToken(consentToken, onGetDelegationToken);
}

function getDelegationToken(consentToken, callback) 
{
   // TODO: Send the consent token to the application serverto decrypt
   // and return the user delegation token.
}

function onGetDelegationToken(delegationToken) 
{
   _identity = new DelegatedAuthIdentity(delegationToken);
   _identity.add_authenticationCompleted(onAuthCompleted);
}

function onAuthCompleted(sender, e) 
{
   var identity = sender;
           
   if (!e.get_authenticationFailure()) 
   {
       user = new Microsoft.Live.Messenger.User(identity);
       _user.add_signInCompleted(onSignInCompleted);
       _user.signIn();
   }
}

function onSignInCompleted(sender, e) 
{
   if (e.get_resultCode() === Microsoft.Live.Messenger.SignInResultCode.success) 
   {
       // Display a confirmation message.
       var paragraph = document.createElement('p');
       var confirmMsg = document.createTextNode(_user.get_address().get_address() + ' is now signed in');
       paragraph.appendChild(confirmMsg);

       document.body.appendChild(paragraph);
   }
}

var loader = Microsoft.Live.Core.Loader;
loader.load(['messenger.core'], onScriptsLoaded);
</pre></div>
            
        </div>
    </div>
</div>

  </div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a class="LW_CollapsibleArea_TitleAhref" title="Collapse" role="heading"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">See Also</span></a><div id="Anchor_4" class="LW_CollapsibleArea_Anchor_Div"><a href="/en-us/library/cc298452.aspx#Anchor_4" class="LW_CollapsibleArea_Anchor_Img" title="Right-click to copy and share the link for this section"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr" /></div></div></h2><div class="sectionblock"><a id="seeAlsoToggle"></a><h4 class="subHeading">Concepts</h4><a href="https://msdn.microsoft.com/en-us/library/cc742836.aspx">How to: Access Windows Live Messenger Resources</a><br /><a href="https://msdn.microsoft.com/en-us/library/cc298462.aspx">Windows Live Messenger Library Tasks</a><br /><br /></div></div>
			
		</div>
      
    </div>
</div>






<div class="libraryMemberFilter">
    <div class="filterContainer">
        <span>Show:</span>
        <label>
            <input type="checkbox" class="libraryFilterInherited" checked="checked" value="Inherit" />Inherited
        </label>
        <label>
            <input type="checkbox" class="libraryFilterProtected" checked="checked" value="Protected" />Protected
        </label>
    </div>
</div>
    
<input type="hidden" id="libraryMemberFilterEmptyWarning" value="There are no members available with your current filter settings." />



    </div>
<div id="rightNavigationMenu" ms.cmpgrp="right nav">
    <div id="mobileButtons">
        <div id="navigationButtons">
            <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/cc298452(d=printer).aspx" rel="nofollow"><ins class="print"></ins>Print </a>
            <a id="isd_printABook" href="/en-us/library/export/help/?returnurl=%2fen-us%2flibrary%2fcc298452.aspx">
                <ins class="export"></ins>Export (<span class="count">0</span>)
            </a>
        </div>
    </div>
    <div id="navMain">
        <div id="closeNavigation">
            <a class="tocCloseSmall" id="closeButton"></a>
        </div>
        <div id="navigationButtons">
            <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/cc298452(d=printer).aspx" rel="nofollow"><ins class="print"></ins>Print </a>
            <a id="isdShare" href="#" role="button" aria-expanded="false">
                <ins class="share"></ins>Share
            </a>
            <div id="socials" style="display: none">
                <a class="isdFacebook" href="#" aria-label="Share on Facebook">
                    <ins class="facebook"></ins>
                </a>
                <a class="isdTwitter" href="#" aria-label="Share on Twitter">
                    <ins class="twitter"></ins>
                </a>
                <a class="isdGooglePlus" href="#" aria-label="Share on Google+">
                    <ins class="googlePlus"></ins>
                </a>
            </div>
        </div>
        <div id="indoc_toc" style="display: none" ms.cmpgrp="indoc toc">
            <div id="indoc_title">IN THIS ARTICLE</div>
            <ul id="indoc_toclist"></ul>
        </div>
    </div>
</div>
<div id="rightNavigationMenuThumbnail" class="rightNavigationMenuThumbnail">
</div>





        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="sPeE2gY3FmImRwm3QNk1zZa4subI9JP9ropqJ1NYZBHpn9MouXhRmh9q1RGOV13ZZkdQ_wYHk9NwtDAF3n6O0-Zym6c1" />
<input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/rate/cc298452.aspx" />
<input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/additional/cc298452.aspx" />
<input id="isTopicRated" type="hidden" value="false" />




    <div id="lib-footer">
        

    
    <link type="text/css" rel="stylesheet" />
    
        
    <div id="ux-footer" class="" style="" dir="ltr" ms.pgarea="footer">


    <div id="standardRatingBefore" class="clear stdr-container-before"></div>
    <div id="standardRating" class="stdr-container" ms.pgarea="body">
        <div class="stdr-close"></div>
        <div class="stdr-vote stdr-content">
            <div class="stdr-content">
                <span class="stdr-votetitle">Is this page helpful?</span>
                <button class="stdr-yes" aria-label="Yes, this page was helpful">Yes</button>
                <button class="stdr-no" aria-label="No, this page was not helpful">No</button>
                <input id="s_ratingValue" type="hidden" value="" />
            </div>
        </div>
        <div class="stdr-feedback" style="display: none">
            <div class="stdr-form">
                <div class="stdr-fieldtitle">Additional feedback?</div>
                <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea>
                <div>
                    <span class="stdr-count"><span class="stdr-charcnt">1500</span> characters remaining</span>
                    <div class="stdr-buttons">
                        <button class="stdr-provide" aria-label="Submit my additional feedback">Submit</button>
                        <button class="stdr-skip" aria-label="Skip additional feedback">Skip this</button>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div class="stdr-thanks" style="display: none">
            <div class="stdr-content">
                <span class="stdr-thankyou">Thank you!</span>
                <span class="stdr-appreciate">We appreciate your feedback.</span>
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
    <div id="standardRatingPlaceholder" style="display: none"></div>
    

        <footer class="top" role="navigation" aria-label="footer">
            <div data-fragmentName="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <h4 class="linkListTitle">Dev centers</h4>
    <ul class="links">
      <li>
        <a href="https://developer.microsoft.com/en-us/windows" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="https://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://www.visualstudio.com/" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="https://docs.microsoft.com/en-us/azure/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">More...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentName="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <h4 class="linkListTitle">Learning resources</h4>
    <ul class="links">
      <li>
        <a href="https://mva.microsoft.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft Virtual Academy</a>
      </li>
      <li>
        <a href="https://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">Channel 9</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN Magazine</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentName="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <h4 class="linkListTitle">Community</h4>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/en-us/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">Forums</a>
      </li>
      <li>
        <a href="https://blogs.msdn.microsoft.com/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">Blogs</a>
      </li>
      <li>
        <a href="https://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentName="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <h4 class="linkListTitle">Support</h4>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">Self support</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentName="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <h4 class="linkListTitle">Programs</h4>
    <ul class="links">
      <li>
        <a href="https://bizspark.microsoft.com/Startups/Index" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark (for startups)</a>
      </li>
      <li>
        <a href="https://imagine.microsoft.com/en-us" id="CenterLinks4_2151_22" xmlns="http://www.w3.org/1999/xhtml">Microsoft Imagine (for students)</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom" role="contentinfo">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/en-us/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fcc298452.aspx" />
        <a href="#" onclick="$('#selectLocaleForm').submit();return false;" title="Change your language">United States (English)</a>
    </form>


            </span>

            <div data-fragmentName="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/en-us/flashnewsletter" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">Newsletter</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/en-us/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">Privacy &amp; cookies</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/en-us/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">Terms of use</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">Trademarks</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logoSpan clip67x13" role="img" tabindex="0" aria-label="microsoft logo">
                    <img alt="logo" class="logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636347038738428747" />
                </span>
                <span class="copyright">© 2017 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>


        <div class="footerPrintView">
            <div class="footerCopyrightPrintView">© 2017 Microsoft</div>
        </div>

        
        

        
        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17" />



        <input id="MtpsDevice" type="hidden" value="Default" />


<![CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]>

        
        
        
            
        

<![CDATA[ WebTrends view model not available or IncludeLegacyWebTrendsScriptInGlobal feature flag is off]]>




<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="k3g6v0VIbaRjD9Hwe6WDSJournj8euUt6v1h9eEEaT3L0Rag5lcBunaUG12k27puxl3MkDlPdfnvRTemIFUTRE2AD5c1" />
</div>


    </div>

    
    

    

    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:Breadcrumbs,4:LibraryRightNavigationMenu,4:PrintExportButton,5:StandardRating,2:Footer,0:Topic,3:ResponsiveSupport,0:AppInsightsPerf,3:ResponsiveToc,0:ABTestControl,4:WEDCS,3:CmpgrpForHeader,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Library/Content:3,/Areas/Library/Themes/Base/Content:4,/Areas/Global/Content:5\u0026amp;hashKey=380CB181B38C487101990C8F514C8659\u0026amp;v=9AED5F3E639AA360E9CEDE569028FD92" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026minimumTermLength=2\u0026pgArea=header\u0026brand=Msdn\u0026loc=en-us\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=Search MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Areas/Epx/Themes/Base/Content/JumpRedirect.js" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027Expand\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027Collapse\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027Click to expand. Double-click to expand all.\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027Click to collapse. Double-click to collapse all.\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027Expand All\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027Collapse All\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:LibraryMemberFilter,1:Toc_Fixed,1:CodeSnippet,1:TopicNotInScope,1:VersionSelector,1:SurveyBroker;/Areas/Library/Content:0,/Areas/Epx/Content/Scripts:1\u0026amp;hashKey=D8D1FFAA6CA68460B7EFA5923975CA44\u0026amp;v=9AED5F3E639AA360E9CEDE569028FD92" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script></body>
</html>
